{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\borrowing.vue?vue&type=style&index=0&id=cc0454aa&scoped=true&lang=css&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\borrowing.vue","mtime":1606385516946},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQovKi5ib3Jyb3dpbmctY29udGFpbmVyIHsNCiAgICBwYWRkaW5nOiAzMHB4IDUwcHg7DQp9DQoNCi5ibG9jayB7DQogICAgcGFkZGluZy10b3A6MzBweDsNCn0NCi5lbC1wYWdpbmF0aW9uIHsNCiAgICBmbG9hdDogcmlnaHQ7DQp9Ki8NCi5kZW1vLWlucHV0LXN1ZmZpeCB7DQogICAgZmxvYXQ6cmlnaHQ7DQogICAgbWFyZ2luOiAzMHB4IDA7DQp9DQouc2VhcmNoSW5wdXQgew0KICAgIHdpZHRoOiA3MCU7DQogICAgbWFyZ2luLXJpZ2h0OiAyMHB4Ow0KfQ0KLmVsLXBhZ2luYXRpb24gew0KICAgIG1hcmdpbi10b3A6IDIwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCn0NCg=="},{"version":3,"sources":["borrowing.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkOA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"borrowing.vue","sourceRoot":"src/components/administrator","sourcesContent":["<template>\r\n    <div class=\"borrowing-container\">\r\n    <div class=\"demo-input-suffix\">\r\n        <el-input\r\n            style=\"width:270px\" maxlength=\"30\" clearable\r\n            placeholder=\"请输入用户姓名\"\r\n            v-model=\"searchBookName\" class=\"searchInput\">\r\n            <i slot=\"prefix\" class=\"el-input__icon el-icon-search\"></i>\r\n        </el-input>\r\n        <el-button type=\"primary\" @click=\"searchBorrowing\">查询</el-button>\r\n    </div>\r\n        <el-table\r\n        :data=\"tableData.slice(0,9)\"\r\n            stripe\r\n            border\r\n            style=\"width: 100%\">\r\n            <el-table-column align=\"center\"\r\n            prop=\"userId\"\r\n            label=\"用户编号\"\r\n            min-width=\"5%\">\r\n            </el-table-column>\r\n            <el-table-column align=\"center\"\r\n            prop=\"userInfo.nickname\"\r\n            label=\"姓名\"\r\n            min-width=\"10%\">\r\n            </el-table-column>\r\n            <el-table-column align=\"center\"\r\n            prop=\"bookId\"\r\n            label=\"图书编号\"\r\n            min-width=\"5%\">\r\n            </el-table-column>\r\n            <el-table-column align=\"center\"\r\n            prop=\"book.bookName\" show-overflow-tooltip\r\n            label=\"图书名称\"\r\n            min-width=\"20%\">\r\n            </el-table-column>\r\n            <el-table-column align=\"center\"\r\n            prop=\"book.author\"\r\n            label=\"作者\"\r\n            min-width=\"10%\">\r\n            </el-table-column>\r\n            <el-table-column prop=\"borrowDate\" label=\"申请借阅时间\" min-width=\"10%\" align=\"center\">\r\n                <template slot-scope=\"scope\">{{scope.row.borrowDate | formatDate}}</template>\r\n            </el-table-column>\r\n            <el-table-column align=\"center\"\r\n            label=\"操作\"\r\n            min-width=\"10%\">\r\n            <template slot-scope=\"scope\">\r\n                <el-button @click=\"pass(scope.row)\" type=\"success\" size=\"small\" plain>审核通过</el-button>\r\n                <el-button @click=\"refuse(scope.row)\" type=\"danger\" size=\"small\" plain>拒绝</el-button>\r\n            </template>\r\n            </el-table-column>\r\n        </el-table>\r\n        <div class=\"block\">\r\n            <el-pagination\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"currentPage\"\r\n            :page-size=\"pageSize\"\r\n            layout=\"total, prev, pager, next ,jumper\"\r\n            :total=\"dataLength\">\r\n            </el-pagination>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport qs from 'qs'\r\nimport {formatDate} from '../../assets/js/time.js'\r\nexport default {\r\n    name: \"borrowing\",\r\n    data() {\r\n        return {\r\n            currentPage: 1, //初始页\r\n            pageSize: 7, //    每页的数据\r\n            searchBookName: \"\",\r\n            tableData: [],\r\n            dataLength: 0\r\n        }\r\n    },\r\n    methods: {\r\n        searchBorrowing() {\r\n            this.currentPage = 1;\r\n            axios({\r\n                 method:'get',\r\n                 url:\"/borrowInfo/fuzzyQuery\",\r\n                 params:{\r\n                     name:this.searchBookName,\r\n                     states:0,\r\n                     currentPage:1,\r\n                     pageSize:this.pageSize\r\n                 }\r\n            }).then(response => {\r\n                let result = response.data;\r\n                if(result.code == 200) {\r\n                    // console.log(result.data);\r\n                    this.tableData = result.data;\r\n                    this.dataLength = result.count;\r\n                    // console.log(this.tableData);\r\n                }\r\n            })\r\n            .catch(error => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: '系统错误',\r\n                    type: 'error'\r\n                });\r\n            })\r\n        },\r\n        pass(row) {\r\n            this.$confirm('此操作将审核通过借阅图书申请, 是否继续?', '提示', {\r\n                cancelButtonText: '取消',\r\n                confirmButtonText: '确定',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                console.log(\"row...\",row)\r\n                axios({\r\n                    url:\"/borrowInfo/operate\",\r\n                    method: \"put\",\r\n                    data:qs.parse({\r\n                        operation:1,\r\n                        id:row.id\r\n                    })\r\n                }).then(response=>{\r\n                    this.getBookSelfData(this.currentPage,this.pageSize)\r\n                    this.$message({\r\n                        type: 'success',\r\n                        message: '审核成功',\r\n                        showClose: true,\r\n                    }); \r\n                }).catch(error=>{\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '系统错误',\r\n                        showClose: true,\r\n                    }); \r\n                })\r\n            }).catch(() => {\r\n                this.$message({\r\n                    type: 'info',\r\n                    message: '已取消审核',\r\n                    showClose: true,\r\n                });          \r\n            });\r\n        },\r\n        refuse(row) {\r\n            this.$confirm('此操作将拒绝通过借阅图书申请, 是否继续?', '提示', {\r\n                cancelButtonText: '取消',\r\n                confirmButtonText: '确定',\r\n            type: 'warning'\r\n            }).then(() => {\r\n                axios({\r\n                    url:\"/borrowInfo/operate\",\r\n                    method: \"put\",\r\n                    data:qs.parse({\r\n                        operation:2,\r\n                        id:row.id\r\n                    })\r\n                }).then(response=>{\r\n                    this.getBookSelfData(this.currentPage,this.pageSize);\r\n                    this.$message({\r\n                        type: 'success',\r\n                        message: '拒绝成功',\r\n                        showClose: true,\r\n                    }); \r\n                }).catch(error=>{\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '拒绝失败',\r\n                        showClose: true,\r\n                    });\r\n                })\r\n            }).catch(() => {\r\n                this.$message({\r\n                    type: 'info',\r\n                    message: '已取消拒绝'\r\n                });          \r\n            });\r\n        },\r\n        getBookSelfData(currentPage,pageSize) {\r\n            axios({\r\n                    method:'get',\r\n                    url:\"/borrowInfo/fuzzyQuery\",\r\n                    params:{\r\n                        name:this.searchBookName,\r\n                        states :0,\r\n                        currentPage:currentPage,\r\n                        pageSize:pageSize \r\n                    }\r\n            }).then(response => {\r\n                let result = response.data;\r\n                if(result.code == 200) {\r\n                    // console.log(result.data);\r\n                    this.tableData = result.data;\r\n                    this.dataLength = result.count;\r\n                    // console.log(this.tableData);\r\n                }\r\n            })\r\n            .catch(error => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: '错误',\r\n                    type: 'error'\r\n                });\r\n            })\r\n        },\r\n        handleCurrentChange(val) {\r\n            this.currentPage = val;\r\n            this.getBookSelfData(this.currentPage,this.pageSize);\r\n            // console.log(`当前页: ${val}`);\r\n        }\r\n        },\r\n    created() {\r\n        this.getBookSelfData(1,this.pageSize);\r\n    },\r\n    filters: {\r\n      formatDate(time) {\r\n        let date = new Date(time);\r\n        // return formatDate(date, 'yyyy-MM-dd hh:mm');\r\n        return formatDate(date, 'yyyy-MM-dd');\r\n      }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/*.borrowing-container {\r\n    padding: 30px 50px;\r\n}\r\n\r\n.block {\r\n    padding-top:30px;\r\n}\r\n.el-pagination {\r\n    float: right;\r\n}*/\r\n.demo-input-suffix {\r\n    float:right;\r\n    margin: 30px 0;\r\n}\r\n.searchInput {\r\n    width: 70%;\r\n    margin-right: 20px;\r\n}\r\n.el-pagination {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n</style>"]}]}