{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\adminLibrary.vue?vue&type=style&index=0&id=c6c86504&scoped=true&lang=css&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\adminLibrary.vue","mtime":1606307997375},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKIA0KLmVsLXNlbGVjdCB7DQogICAgd2lkdGg6IDIyMHB4Ow0KfQ0KLnNlbGVjdEJveCB7DQogICAgbWFyZ2luLXRvcDogMTBweDsNCiAgICBmbG9hdDogcmlnaHQ7DQp9DQouZGVtby1pbnB1dC1zdWZmaXggew0KICAgIG1hcmdpbi1ib3R0b206IDIwcHg7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KfQ0KLnNlYXJjaElucHV0IHsNCiAgICB3aWR0aDogMzAwcHg7DQogICAgbWFyZ2luLXJpZ2h0OiAyMHB4Ow0KfQ0KLmVsLXBhZ2luYXRpb24gew0KICAgIG1hcmdpbi10b3A6IDIwcHg7DQogICAgZGlzcGxheTogZmxleDsNCiAgICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCn0NCi5hZGRJbnB1dCB7DQogICAgd2lkdGg6IDIyMHB4Ow0KfQ0KICAgIC8qLmVsLXNlbGVjdCB7DQogICAgICAgIHdpZHRoOiAxNjRweDsNCiAgICB9DQogICAgDQogICAgLmVsLXJvdyB7DQogICAgICAgIG1hcmdpbi10b3A6IDEwcHg7DQogICAgICAgIHdpZHRoOiAxM3B4Ow0KICAgICAgICBtYXJnaW4tbGVmdDogNzclOw0KICAgIH0NCiAgICANCiAgICAuZWwtdGFibGUgew0KICAgICAgICBtYXJnaW4tdG9wOiAyJTsNCiAgICAgICAgbWFyZ2luLWxlZnQ6IDEyLjUlOw0KICAgIH0NCiAgICANCiAgICAuZWwtcGFnaW5hdGlvbiB7DQogICAgICAgIG1hcmdpbi10b3A6IDMlOw0KICAgIH0NCiAgICANCiAgICAuYiB7DQogICAgICAgIG1hcmdpbi1sZWZ0OiA0NSU7DQogICAgfQ0KICAgIC5pbmZvcm1hdGlvbiB7DQogICAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7DQogICAgICBkaXNwbGF5OiAtd2Via2l0LWJveDsNCiAgICAgIC13ZWJraXQtYm94LW9yaWVudDogdmVydGljYWw7DQogICAgICAtd2Via2l0LWxpbmUtY2xhbXA6IDQ7DQogICAgfSovDQo="},{"version":3,"sources":["adminLibrary.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAksBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"adminLibrary.vue","sourceRoot":"src/components/administrator","sourcesContent":["<template>\r\n  <div class=\"adminLibrary-container\">\r\n    <div class=\"selectBox\">\r\n        <el-form :inline=\"true\" class=\"demo-form-inline\">\r\n            <el-form-item label=\"国家\">\r\n            <el-select v-model=\"country\">\r\n                <el-option v-for=\"item in defaultData\" :label=\"item.defaultName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                <el-option v-for=\"item in countryData \" :label=\"item.countryName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n            </el-select>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"类型\">\r\n            <el-select v-model=\"type\">\r\n                <el-option v-for=\"item in defaultData\" :label=\"item.defaultName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                <el-option v-for=\"item in typeData \" :label=\"item.typeName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n            </el-select>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"篇幅\">\r\n            <el-select v-model=\"space\">\r\n                <el-option v-for=\"item in spaceData\" :label=\"item.spaceName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n            </el-select>\r\n            </el-form-item>\r\n\r\n            <el-form-item label=\"主题\">\r\n            <el-select v-model=\"theme\">\r\n                <el-option v-for=\"item in defaultData\" :label=\"item.defaultName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                <el-option v-for=\"item in themeData \" :label=\"item.themeName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n            </el-select>\r\n            </el-form-item>\r\n            <el-form-item style=\"margin-right:0\">\r\n                <el-button type=\"primary\" @click=\"query\">查询</el-button>\r\n                <el-button @click=\"reset\">重置</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n    </div>\r\n\r\n    <div class=\"demo-input-suffix\">\r\n        <el-input\r\n            placeholder=\"请输入图书名称\" clearable maxlength=\"30\"\r\n            v-model=\"searchBookName\" class=\"searchInput\">\r\n            <i slot=\"prefix\" class=\"el-input__icon el-icon-search\"></i>\r\n        </el-input>\r\n        <el-button type=\"primary\" @click=\"searchBook\">搜索</el-button>\r\n        <el-button type=\"success\" @click=\"addOpenDialog\">添加图书</el-button>\r\n    </div>  \r\n\r\n    <el-dialog title=\"添加书籍\" :visible.sync=\"dialogAddFormVisible\" width=\"50%\" center \r\n        :before-close=\"handAddClose\">\r\n        <div style=\"padding:0 50px\">\r\n        <el-row :gutter=\"30\">\r\n            <el-form ref=\"addFormRef\" label-width=\"100px\" :model=\"addForm\" :rules=\"rules\">\r\n                <el-col :span=\"12\">\r\n                    <el-form-item label=\"图书名称\" prop=\"add_bookName\">\r\n                        <el-input v-model.trim=\"addForm.add_bookName\" class=\"addInput\"></el-input>\r\n                    </el-form-item>\r\n                </el-col>\r\n                <el-col :span=\"12\">\r\n                    <el-form-item label=\"作者名称\" prop=\"add_author\">\r\n                        <el-input v-model=\"addForm.add_author\" class=\"addInput\"></el-input>\r\n                    </el-form-item>\r\n                </el-col>\r\n                <el-col :span=\"12\">\r\n                    <el-form-item label=\"图书数量\" prop=\"add_bookCount\">\r\n                        <el-input v-model=\"addForm.add_bookCount\" class=\"addInput\"></el-input>\r\n                    </el-form-item>\r\n                </el-col>\r\n                <el-col :span=\"12\">\r\n                <el-form-item label=\"国家\" prop=\"add_country\">\r\n                    <el-select v-model=\"addForm.add_country\">\r\n                        <el-option v-for=\"item in countryData \" :label=\"item.countryName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                </el-col>\r\n                <el-col :span=\"12\">\r\n                    <el-form-item label=\"类型\" prop=\"add_type\">\r\n                        <el-select v-model=\"addForm.add_type\">\r\n                            <el-option v-for=\"item in typeData \" :label=\"item.typeName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                </el-col>\r\n                <el-col :span=\"12\">\r\n                    <el-form-item label=\"篇幅\" prop=\"add_space\">\r\n                        <el-select v-model=\"addForm.add_space\">\r\n                            <el-option v-for=\"item in spaceAddData\" :label=\"item.spaceName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                </el-col>\r\n                <el-col :span=\"12\">\r\n                    <el-form-item label=\"主题\" prop=\"add_theme\">\r\n                        <el-select v-model=\"addForm.add_theme\">\r\n                            <el-option v-for=\"item in themeData \" :label=\"item.themeName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                        </el-select>\r\n                    </el-form-item>\r\n                </el-col>\r\n                <el-col :span=\"24\">\r\n                    <el-form-item label=\"简介\" prop=\"add_info\">\r\n                        <el-input type=\"textarea\" :rows=\"8\" v-model=\"addForm.add_info\" resize=\"none\" style=\"width:560px\"\r\n                        placeholder=\"请输入图书简介\"></el-input>\r\n                    </el-form-item>\r\n                </el-col>\r\n            </el-form>\r\n        </el-row>\r\n        </div>\r\n        <span slot=\"footer\" class=\"dialog-footer\">\r\n            <el-button type=\"primary\" @click=\"add\">添加图书</el-button>\r\n            <el-button @click=\"close()\">取消</el-button>\r\n        </span>\r\n    </el-dialog>\r\n    <el-table :data=\"tableData.slice(0,7)\" border stripe style=\"width: 100%;\">\r\n        <el-table-column prop=\"id\" label=\"图书编号\" min-width=\"5%\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"bookName\" label=\"图书名称\" min-width=\"8%\" align=\"center\" show-overflow-tooltip>\r\n        </el-table-column>\r\n        <el-table-column prop=\"author\" label=\"作者\" min-width=\"8%\" align=\"center\" show-overflow-tooltip>\r\n        </el-table-column>\r\n        <el-table-column prop=\"country.countryName\" label=\"国家\" min-width=\"5%\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"type.typeName\" label=\"类型\" min-width=\"5%\" align=\"center\"> </el-table-column>\r\n        <el-table-column prop=\"theme.themeName\" label=\"主题\" min-width=\"5%\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"space\" label=\"篇幅\" min-width=\"5%\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"bookCount\" label=\"图书数量\" min-width=\"3%\" align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column prop=\"createDate\" label=\"上架日期\" min-width=\"6%\" align=\"center\">\r\n            <template slot-scope=\"scope\">{{scope.row.createDate | formatDate}}</template>\r\n        </el-table-column>\r\n        <el-table-column prop=\"info\" label=\"简介\" min-width=\"15%\" show-overflow-tooltip align=\"center\">\r\n        </el-table-column>\r\n        <el-table-column fixed=\"right\" label=\"操作\" min-width=\"8%\" align=\"center\">\r\n            <template slot-scope=\"scope\">\r\n            <el-button\r\n                @click=\"edit(scope.$index, scope.row)\"\r\n                type=\"info\"\r\n                size=\"small\" plain>编辑</el-button>\r\n            <el-button type=\"danger\" size=\"small\" @click=\"deleteBook(scope.row)\" plain>删除</el-button>\r\n            </template>\r\n        </el-table-column>\r\n    </el-table>\r\n    <el-dialog title=\"图书详情\" :visible.sync=\"dialogFormVisible\" width=\"50%\" center :before-close=\"handleClose\">\r\n        <div>\r\n            <el-form :model=\"editData\" label-width=\"100px\" :inline=\"true\" :rules=\"rules\" ref=\"editFormRef\">\r\n                <el-form-item label=\"图书名称\" prop=\"bookName\">\r\n                    <el-input v-model=\"editData.bookName\" class=\"addInput\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"作者名称\" prop=\"author\">\r\n                    <el-input v-model=\"editData.author\" class=\"addInput\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"数量\" prop=\"bookCount\">\r\n                    <el-input v-model=\"editData.bookCount\" class=\"addInput\"></el-input>\r\n                </el-form-item>\r\n                <el-form-item label=\"国家\" v-if=\"editData.country != undefined\" prop=\"country\">\r\n                    <el-select v-model=\"editData.country.id\" >\r\n                       <el-option v-for=\"item in countryData \" :label=\"item.countryName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>     \r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"类型\" v-if=\"editData.type != undefined\" prop=\"type\">\r\n                    <el-select v-model=\"editData.type.id\" >\r\n                        <el-option v-for=\"item in typeData \" :label=\"item.typeName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"篇幅\" prop=\"space\"> \r\n                    <el-select v-model=\"editData.space\">\r\n                        <el-option v-for=\"item in spaceAddData\" :label=\"item.spaceName\" :value=\"item.spaceName\" v-bind:key=\"item.id\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <el-form-item label=\"主题\" v-if=\"editData.theme != undefined\" prop=\"theme\">\r\n                    <el-select v-model=\"editData.theme.id\" >\r\n                        <el-option v-for=\"item in themeData \" :label=\"item.themeName\" :value=\"item.id\" v-bind:key=\"item.id\"></el-option>\r\n                    </el-select>\r\n                </el-form-item>\r\n                <div>\r\n                    <el-form-item label=\"简介\" prop=\"info\">\r\n                        <el-input type=\"textarea\" :rows=\"8\" v-model=\"editData.info\" resize=\"none\" style=\"width:550px\"></el-input>\r\n                    </el-form-item>\r\n                </div>\r\n            </el-form>\r\n        </div>\r\n        <div slot=\"footer\" class=\"dialog-footer\">\r\n            <el-button type=\"primary\" @click=\"save\" ailgn=\"right\">保存图书</el-button>\r\n            <el-button type=\"text\" @click=\"onSubmit4\">取消</el-button>\r\n        </div>\r\n    </el-dialog>\r\n    <el-pagination @current-change=\"handleCurrentChange\"\r\n        @size-change=\"handleSizeChange\"\r\n        :current-page=\"currentPage\"\r\n        :page-size=\"pagesize\"\r\n        layout=\"total,prev,pager,next,jumper\" :total=\"dataLength\">\r\n    </el-pagination>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport qs from 'qs'\r\nimport {formatDate} from '../../assets/js/time.js'\r\n    export default {\r\n        name: \"adminLibrary\",\r\n        created() {\r\n            this.getBookData(1,this.pagesize);\r\n            this.getCountryData();\r\n            this.getThemeData(),\r\n            this.getTypeData()\r\n        },\r\n        data() {\r\n            var validateCount = (rule,value,callback) => {\r\n                let reg = /^[0-9]+$/;\r\n                if(value.length > 4) {\r\n                    callback('图书数量过多')\r\n                }\r\n                if(!reg.test(value)){\r\n                    callback(\"图书数量输入错误\");\r\n                }else{\r\n                    callback();\r\n                }\r\n            };\r\n            return {\r\n                rules: {\r\n                    add_bookName: [\r\n                        { required: true, message: '请输入图书名称', trigger: 'blur' }\r\n                    ],\r\n                    add_author: [\r\n                        { required: true, message: '请输入图书作者', trigger: 'blur' }\r\n                    ],\r\n                    add_info: [\r\n                        { required: true, message: '请输入图书简介', trigger: 'blur' }\r\n                    ],\r\n                    add_country: [\r\n                        { required: true, message: '请选择图书国家', trigger: 'blur' }\r\n                    ],\r\n                    add_type: [\r\n                        { required: true, message: '请选择图书类型', trigger: 'blur' }\r\n                    ],\r\n                    add_theme: [\r\n                        { required: true, message: '请选择图书主题', trigger: 'blur' }\r\n                    ],\r\n                    add_space: [\r\n                        { required: true, message: '请选择图书篇幅', trigger: 'blur' }\r\n                    ],\r\n                    add_bookCount: [\r\n                        { required: true, message: '请输入图书数量', trigger: 'blur' },\r\n                        { validator:validateCount, trigger: 'blur' }\r\n                    ],\r\n                    bookName: [\r\n                        { required: true, message: '请输入图书名称', trigger: 'blur' }\r\n                    ],\r\n                    author: [\r\n                        { required: true, message: '请输入图书作者', trigger: 'blur' }\r\n                    ],\r\n                    info: [\r\n                        { required: true, message: '请输入图书简介', trigger: 'blur' }\r\n                    ],\r\n                    country: [\r\n                        { required: true, message: '请选择图书国家', trigger: 'blur' }\r\n                    ],\r\n                    type: [\r\n                        { required: true, message: '请选择图书类型', trigger: 'blur' }\r\n                    ],\r\n                    theme: [\r\n                        { required: true, message: '请选择图书主题', trigger: 'blur' }\r\n                    ],\r\n                    space: [\r\n                        { required: true, message: '请选择图书篇幅', trigger: 'blur' }\r\n                    ],\r\n                    bookCount: [\r\n                        { required: true, message: '请输入图书数量', trigger: 'blur' },\r\n                        { validator:validateCount, trigger: 'blur' }\r\n                    ]\r\n                },\r\n                isBorrowing:true,\r\n                dialogFormVisible: false,\r\n                dialogAddFormVisible: false,\r\n                currentPage: 1, //初始页\r\n                pagesize: 7, //    每页的数据\r\n                visible: false,\r\n                country:0,\r\n                type:0,\r\n                theme:0,\r\n                space:0,\r\n                dataLength:0,\r\n                edit_space:0,\r\n                searchBookName: \"\",\r\n                defaultData:[{\"id\":0,\"defaultName\":\"默认\"}],\r\n                tableData: [],\r\n                countryData: [],\r\n                themeData: [],\r\n                typeData: [],\r\n                spaceData:[\r\n                  {\"id\":0,\"spaceName\":\"默认\"},\r\n                  {\"id\":1,\"spaceName\":\"短篇\"},\r\n                  {\"id\":2,\"spaceName\":\"中篇\"},\r\n                  {\"id\":3,\"spaceName\":\"长篇\"},\r\n                ],\r\n                spaceAddData:[\r\n                  {\"id\":1,\"spaceName\":\"短篇\"},\r\n                  {\"id\":2,\"spaceName\":\"中篇\"},\r\n                  {\"id\":3,\"spaceName\":\"长篇\"},\r\n                ],\r\n                editData:{},\r\n                addForm:{\r\n                    add_bookName:\"\",\r\n                    add_author:\"\",\r\n                    add_info:\"\",\r\n                    add_country:0,\r\n                    add_type:0,\r\n                    add_theme:0,\r\n                    add_space:1,\r\n                    add_bookCount:0,\r\n                },\r\n                dialogVisible: false,\r\n                dialogTableVisible: false,\r\n            };\r\n        },\r\n        methods: {\r\n            handleClose(){\r\n                this.$refs.editFormRef.resetFields(); \r\n                this.dialogFormVisible = false;\r\n            },\r\n            handAddClose(done){\r\n                this.$nextTick(() => {\r\n                    this.$refs.addFormRef.resetFields();  \r\n                });\r\n                this.dialogAddFormVisible = false;\r\n            },\r\n            addOpenDialog(){\r\n                this.dialogAddFormVisible = true;\r\n            },\r\n            close(){\r\n                this.dialogAddFormVisible = false;\r\n            },\r\n            \r\n            deleteBook(row) {\r\n                this.BookIsBorrowing(row.id);\r\n                this.$confirm('此操作将删除该图书, 是否继续?', '提示', {\r\n                        confirmButtonText: '确定',\r\n                        cancelButtonText: '取消',\r\n                        type: 'warning'\r\n                    })\r\n                    .then(() => {\r\n                        if(this.isBorrowing){\r\n                                this.$message({\r\n                                    showClose: true,\r\n                                    message: '书籍正在被借阅，不能被删除',\r\n                                    type: 'error'\r\n                                });\r\n                            }else{\r\n                                 axios({\r\n                                    method:'delete',\r\n                                    url:\"/book/\"+row.id,\r\n                                }).then(response => {\r\n                                    console.log(this.isBorrowing);\r\n                                    this.getBookData(this.currentPage,this.pagesize);\r\n                                    this.$message({\r\n                                        showClose: true,\r\n                                        message: '删除成功',\r\n                                        type: 'success'\r\n                                    });\r\n                                })\r\n                                .catch(error => {\r\n                                    this.$message({\r\n                                        showClose: true,\r\n                                        message: '删除错误',\r\n                                        type: 'error'\r\n                                    });\r\n                                })\r\n                            }\r\n                    })\r\n                    .catch(() => {\r\n                        this.$message({\r\n                            type: 'info',\r\n                            message: '已取消删除'\r\n                        });\r\n                    });\r\n            },\r\n            getBookData(currentPage,pageSize){\r\n                axios({\r\n                    method:'post',\r\n                    url:\"/book/query\",\r\n                    data:qs.parse({\r\n                        nickName:this.searchBookName,\r\n                        currentPage:currentPage,\r\n                        pageSize:pageSize,\r\n                        country_id:this.country,\r\n                        theme_id:this.theme,\r\n                        type_id:this.type,\r\n                        space:this.space\r\n                    })\r\n                }).then(response=>{\r\n                    let result = response.data;\r\n                    if(result.code == 999) {\r\n                        console.log(result.data);\r\n                        this.tableData = result.data;\r\n                        this.dataLength = result.count;\r\n                        console.log(this.tableData);\r\n                    }\r\n                }).catch(error=>{\r\n                    this.$message({\r\n                        showClose: true,\r\n                        message: '错误',\r\n                        type: 'error'\r\n                    });\r\n                })\r\n            },\r\n            getCountryData(){\r\n                axios({\r\n                    method:'get',\r\n                    url:\"/country\",\r\n                }).then(response => {\r\n                    let result = response.data;\r\n                    if(result.code == 200) {\r\n                        console.log(result.data);\r\n                        this.addForm.add_country = result.data[0].id;\r\n                        this.countryData = result.data;\r\n                        console.log(this.countryData);\r\n                    }\r\n                 })\r\n                .catch(error => {\r\n                    this.$message({\r\n                        showClose: true,\r\n                        message: '错误',\r\n                        type: 'error'\r\n                    });\r\n                })\r\n            },\r\n            getThemeData(){\r\n                axios({\r\n                    method:'get',\r\n                    url:\"/theme\",\r\n                }).then(response => {\r\n                    let result = response.data;\r\n                    if(result.code == 200) {\r\n                        this.addForm.add_theme = result.data[0].id;\r\n                        console.log(result.data);\r\n                        this.themeData = result.data;\r\n                        console.log(this.themeData);\r\n                    }\r\n                 })\r\n                .catch(error => {\r\n                    this.$message({\r\n                        showClose: true,\r\n                        message: '错误',\r\n                        type: 'error'\r\n                    });\r\n                })\r\n            },\r\n            getTypeData(){\r\n                axios({\r\n                    method:'get',\r\n                    url:\"/type\",\r\n                }).then(response => {\r\n                    let result = response.data;\r\n                    if(result.code == 200) {\r\n                        this.addForm.add_type = result.data[0].id;\r\n                        console.log(result.data);\r\n                        this.typeData = result.data;\r\n                        console.log(this.typeData);\r\n                    }\r\n                 })\r\n                .catch(error => {\r\n                    this.$message({\r\n                        showClose: true,\r\n                        message: '错误',\r\n                        type: 'error'\r\n                    });\r\n                })\r\n            },\r\n            handleClick(row) {\r\n                console.log(row);\r\n            },\r\n            edit(index, row) {\r\n                this.dialogFormVisible = true;\r\n                this.editData = row;\r\n            },\r\n\r\n            add() {\r\n                this.currentPage = 1,\r\n                this.$refs['addFormRef'].validate((valid) => {\r\n                    if(valid) {\r\n                        axios({\r\n                            method:'post',\r\n                            url:\"/book\",\r\n                            data:qs.parse({\r\n                                bookName:this.addForm.add_bookName,\r\n                                author:this.addForm.add_author,\r\n                                country_id:this.addForm.add_country,\r\n                                theme_id:this.addForm.add_theme,\r\n                                type_id:this.addForm.add_type,\r\n                                space_count:this.addForm.add_space,\r\n                                info:this.addForm.add_info,\r\n                                bookCount:this.addForm.add_bookCount\r\n                            })\r\n                        }).then(response => {\r\n                                if(response.data.code == 200) {\r\n                                    this.close();\r\n                                    this.getBookData(this.currentPage,this.pagesize);\r\n                                    this.$message({\r\n                                        showClose: true,\r\n                                        message: '添加成功',\r\n                                        type: 'success'\r\n                                    });\r\n                                }else {\r\n                                    this.$message({\r\n                                        showClose: true,\r\n                                        message: '添加失败',\r\n                                        type: 'error'\r\n                                    });\r\n                                }\r\n                        }).catch(error => {\r\n                            this.$message({\r\n                                showClose: true,\r\n                                message: '添加失败',\r\n                                type: 'error'\r\n                            });\r\n                        })\r\n                    }else {\r\n                        this.$message({\r\n                            showClose: true,\r\n                            message: '添加失败',\r\n                            type: 'error'\r\n                        });\r\n                    }\r\n                })\r\n            },\r\n            save() {\r\n                this.$refs['editFormRef'].validate((valid) => {\r\n                    if(valid) {\r\n                        axios({\r\n                        method:'put',\r\n                        url:\"/book\",\r\n                        data:qs.parse({\r\n                            id:Number.parseInt(this.editData.id),\r\n                            bookName:this.editData.bookName,\r\n                            author:this.editData.author,\r\n                            country_id:Number.parseInt(this.editData.country.id),\r\n                            theme_id:Number.parseInt(this.editData.theme.id),\r\n                            type_id:Number.parseInt(this.editData.type.id),\r\n                            space:this.editData.space,\r\n                            bookCount:Number.parseInt(this.editData.bookCount),\r\n                            info:this.editData.info\r\n                        })\r\n                        }).then(response=>{\r\n                                // console.log(this.editData);\r\n                            if(response.data.code == 200) {\r\n                                this.getBookData(this.currentPage,this.pagesize);\r\n                                this.handleClose();\r\n                                this.$message({\r\n                                    showClose: true,\r\n                                    message: '保存成功',\r\n                                    type: 'success'\r\n                                });\r\n                            }else {\r\n                                this.$message({\r\n                                    showClose: true,\r\n                                    message: '保存失败',\r\n                                    type: 'error'\r\n                                });\r\n                            }\r\n                        }).catch(error=>{\r\n                            this.$message({\r\n                                showClose: true,\r\n                                message: '保存失败',\r\n                                type: 'error'\r\n                            });\r\n                        })\r\n                    }else {\r\n                        this.$message({\r\n                            type: 'error',\r\n                            message: '保存失败',\r\n                            showClose: true,\r\n                        });\r\n                    }\r\n                })\r\n            },\r\n            reset(){\r\n                this.currentPage=1;\r\n                this.searchBookName=\"\";\r\n                this.space=0;\r\n                this.type=0;\r\n                this.theme=0;\r\n                this.country=0;\r\n                this.getBookData(this.currentPage,this.pagesize);\r\n            },\r\n            onSubmit4() {\r\n                        this.dialogFormVisible = false;\r\n                        this.getBookData(this.currentPage,this.pagesize);\r\n                        this.$message({\r\n                            type: \"info\",\r\n                            message: \"已取消修改\",\r\n                        });\r\n            },\r\n\r\n            searchBook() {\r\n                this.currentPage = 1;\r\n                axios({\r\n                    url:\"/book/query\",\r\n                    method: \"post\",\r\n                    data:qs.parse({\r\n                        nickname:this.searchBookName,\r\n                        currentPage:this.currentPage,\r\n                        pageSize:this.pagesize,\r\n                        country_id:this.country,\r\n                        theme_id:this.theme,\r\n                        type_id:this.type,\r\n                        space:this.space\r\n                    })\r\n                }).then(response=>{\r\n                    console.log(response);\r\n                    let result = response.data;\r\n                    if(result.code == 999) {\r\n                        console.log(this.searchBookName);\r\n                        console.log(result.data);\r\n                        this.tableData = result.data;\r\n                        this.dataLength = result.count;\r\n                    }\r\n                }).catch(error=>{\r\n                    this.$message({\r\n                        showClose: true,\r\n                        message: '错误',\r\n                        type: 'error'\r\n                    });\r\n                })\r\n            },\r\n            open() {\r\n                this.$confirm(\"是否确定添加此书\", \"提示\", {\r\n                        confirmButtonText: \"确定\",\r\n                        cancelButtonText: \"取消\",\r\n                        type: \"warning\",\r\n                    })\r\n                    .then(() => {\r\n                        this.$message({\r\n                            type: \"success\",\r\n                            message: \"添加成功!\",\r\n                        });\r\n                    })\r\n                    .catch(() => {\r\n                        this.$message({\r\n                            type: \"info\",\r\n                            message: \"已取消添加\",\r\n                        });\r\n                    });\r\n            },\r\n\r\n            query() {\r\n                this.currentPage = 1;\r\n                console.log(this.searchBookName);\r\n                axios({\r\n                    url:\"/book/query\",\r\n                    method: \"post\",\r\n                    data:qs.parse({\r\n                        nickname:this.searchBookName,\r\n                        currentPage:this.currentPage,\r\n                        pageSize:this.pagesize,\r\n                        country_id:this.country,\r\n                        theme_id:this.theme,\r\n                        type_id:this.type,\r\n                        space:this.space\r\n                    })\r\n                }).then(response=>{\r\n                    let result = response.data;\r\n                    if(result.code == 999) {\r\n                        console.log(result.data);\r\n                        this.tableData = result.data;\r\n                        this.dataLength = result.count;\r\n                        console.log(this.tableData);\r\n                    }\r\n                }).catch(error=>{\r\n                    this.$message({\r\n                        showClose: true,\r\n                        message: '错误',\r\n                        type: 'error'\r\n                    });\r\n                })\r\n            },\r\n            handleUserList() {},\r\n            handleSizeChange(val) {\r\n                this.pagesize = val;\r\n            },\r\n            handleCurrentChange(val) {\r\n                this.currentPage = val;\r\n                this.getBookData(this.currentPage,7);\r\n            },\r\n            BookIsBorrowing(bookId){\r\n                axios({\r\n                    method:'get',\r\n                    url:'/borrowInfo/bookIsBorrowing',\r\n                    params:{\r\n                        bookId:bookId,\r\n                    }\r\n                }).then(response=>{\r\n                    let result = response.data;\r\n                   this.isBorrowing = result.data;\r\n                })\r\n            }\r\n        },\r\n        filters: {\r\n            formatDate(time) {\r\n                let date = new Date(time);\r\n                // return formatDate(date, 'yyyy-MM-dd hh:mm');\r\n                return formatDate(date, 'yyyy-MM-dd');\r\n            }\r\n        }\r\n    };\r\n</script>\r\n\r\n<style scoped> \r\n.el-select {\r\n    width: 220px;\r\n}\r\n.selectBox {\r\n    margin-top: 10px;\r\n    float: right;\r\n}\r\n.demo-input-suffix {\r\n    margin-bottom: 20px;\r\n    float: right;\r\n}\r\n.searchInput {\r\n    width: 300px;\r\n    margin-right: 20px;\r\n}\r\n.el-pagination {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: center;\r\n}\r\n.addInput {\r\n    width: 220px;\r\n}\r\n    /*.el-select {\r\n        width: 164px;\r\n    }\r\n    \r\n    .el-row {\r\n        margin-top: 10px;\r\n        width: 13px;\r\n        margin-left: 77%;\r\n    }\r\n    \r\n    .el-table {\r\n        margin-top: 2%;\r\n        margin-left: 12.5%;\r\n    }\r\n    \r\n    .el-pagination {\r\n        margin-top: 3%;\r\n    }\r\n    \r\n    .b {\r\n        margin-left: 45%;\r\n    }\r\n    .information {\r\n      overflow: hidden;\r\n      text-overflow: ellipsis;\r\n      display: -webkit-box;\r\n      -webkit-box-orient: vertical;\r\n      -webkit-line-clamp: 4;\r\n    }*/\r\n</style>"]}]}