{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\user\\userInformation.vue?vue&type=style&index=0&id=bd7bb0a6&scoped=true&lang=css&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\user\\userInformation.vue","mtime":1606378168275},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLnVzZXJJbmZvcm1hdGlvbi1jb250YWluZXIgew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgbWFyZ2luLXRvcDogNTBweDsNCn0NCi5pbmZvcm1hdGlvbiB7DQogIGJhY2tncm91bmQtY29sb3I6ICNmZmY7DQogIGhlaWdodDogMTAwJTsNCiAgd2lkdGg6IDEwMDBweDsNCiAgYm94LXNoYWRvdzogMCAycHggNHB4IHJnYmEoMCwgMCwgMCwgLjEyKSwgMCAwIDZweCByZ2JhKDAsIDAsIDAsIC4wNCk7DQogIHBhZGRpbmc6IDMwcHg7DQogIGJvcmRlci1yYWRpdXM6IDNweDsNCn0NCi5idG4gew0KICBtYXJnaW46IDEwcHggNDUlOw0KfQ0KDQo="},{"version":3,"sources":["userInformation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"userInformation.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\r\n  <div class=\"userInformation-container\">\r\n    <el-form\r\n      ref=\"form\"\r\n      :model=\"form\"\r\n      :rules=\"rules\"\r\n      label-width=\"80px\"\r\n      class=\"information\"\r\n      label-position=\"left\">\r\n      <el-row>\r\n        <el-col :span=\"24\">\r\n        <p style=\"font-size:25px;text-align:center;\">个人资料</p>\r\n          <el-divider></el-divider>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"用户编号\">\r\n            <el-input\r\n              disabled=\"disabled\"\r\n              v-model=\"form.userId\"\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"用户名\">\r\n            <el-input\r\n              disabled=\"disabled\"\r\n              v-model=\"form.username\"\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"信用分\">\r\n            <el-input\r\n              disabled=\"disabled\"\r\n              v-model=\"form.credit\"\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row :gutter=\"20\">\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"姓名\" prop=\"nickname\">\r\n            <el-input\r\n              v-model=\"form.nickname\"\r\n              placeholder=\"请输入姓名\"\r\n              clearable\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"年龄\" prop=\"age\">\r\n            <el-input\r\n              v-model=\"form.age\"\r\n              placeholder=\"请输入年龄\"\r\n              clearable\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"性别\" prop=\"sex\">\r\n              <el-radio label=\"男\" v-model=\"form.sex\"></el-radio>\r\n              <el-radio label=\"女\" v-model=\"form.sex\"></el-radio>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"邮箱\" prop=\"email\">\r\n            <el-input\r\n              v-model=\"form.email\"\r\n              placeholder=\"请输入邮箱\"\r\n              clearable\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"8\">\r\n          <el-form-item label=\"电话\" prop=\"telephone\">\r\n            <el-input\r\n              v-model=\"form.telephone\"\r\n              placeholder=\"请输入电话\"\r\n              clearable\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"6\">\r\n          <el-form-item label=\"出生日期\" prop=\"birthday\">\r\n              <el-date-picker\r\n                :picker-options=\"picker1\"\r\n                style=\"width:155%\"\r\n                v-model=\"form.birthday\"\r\n                type=\"date\"\r\n                placeholder=\"选择日期\">\r\n              </el-date-picker>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"地址\" prop=\"address\">\r\n            <el-input\r\n              v-model=\"form.address\"\r\n              placeholder=\"请输入家庭地址\"\r\n              clearable\r\n              maxlength=\"100\"\r\n              show-word-limit\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n        <el-col :span=\"24\">\r\n          <el-form-item label=\"个人描述\" prop=\"personalDesc\">\r\n            <el-input\r\n              :rows=\"4\"\r\n              type=\"textarea\"\r\n              v-model=\"form.personalDesc\"\r\n              placeholder=\"请输入内容\"\r\n              maxlength=\"100\"\r\n              show-word-limit\r\n              resize=\"none\"\r\n            ></el-input>\r\n          </el-form-item>\r\n        </el-col>\r\n      </el-row>\r\n      <el-row>\r\n        <el-button type=\"primary\" @click=\"submit('form')\" class=\"btn\">保存</el-button>\r\n        <p style=\"line-height:20px;margin:0;padding:0;color:red\">备注：信用分低于60分将限制借阅图书操作</p>\r\n      </el-row>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Axios from 'axios';\r\nimport qs from 'qs'\r\nexport default {\r\n  name: \"userInformation\",\r\n  props: {\r\n    msg: String,\r\n  },\r\n  data() {\r\n    var validatorAge = (rule, value, callback) => {\r\n        let reg= new RegExp(\"^[0-9][0-9]?[0-9]?$\");\r\n        if(!reg.test(value)) {\r\n          callback('年龄输入不合法');\r\n        }else if(value>120){\r\n          callback('年龄输入不合法');\r\n        }\r\n        else {\r\n          callback();\r\n        }\r\n    };\r\n    return {\r\n      selectDate: new Date(),\r\n      form: {\r\n        credit:\"\",\r\n        username:\"\",\r\n        nickname: \"\",\r\n        personalDesc: \"\",\r\n        birthday: \"\",\r\n        sex: \"男\",\r\n        age: \"\",\r\n        address: \"\",\r\n        telephone: \"\",\r\n        email: \"\",\r\n        id:\"\",\r\n        userId:\"\"\r\n      },\r\n      picker1: {\r\n        disabledDate:(time) => {\r\n           return time.getTime() > Date.now() - 8.64e7;\r\n        }\r\n      },\r\n      rules: {\r\n        nickname: [\r\n          {\r\n            required: true,\r\n            message: \"请输入姓名\",\r\n            trigger: \"blur\",\r\n          },\r\n          {\r\n            min: 3,\r\n            max: 20,\r\n            message: \"姓名的长度在 3 到 20 位之间\",\r\n          },\r\n          // {\r\n          //   pattern: /^[\\u4E00-\\u9FA5]+$/,\r\n          //   message: \"用户名只能为中文\",\r\n          // },\r\n        ],\r\n        sex: [\r\n          {\r\n            required: true,\r\n            message: \"请选择性别\",\r\n            trigger: \"blur\",\r\n          },\r\n        ],\r\n        age: [\r\n          {\r\n            required: true,\r\n            message: \"请输入年龄\",\r\n            trigger: \"blur\",\r\n          },\r\n          { validator: validatorAge, trigger: 'blur' }\r\n        ],\r\n        email: [\r\n          {\r\n            required: true,\r\n            message: \"请输入邮箱\",\r\n            trigger: \"blur\",\r\n          },\r\n          {\r\n            min: 1,\r\n            max: 30,\r\n            message: \"邮箱的长度在 1 到 30 位之间\",\r\n          },\r\n          {\r\n            pattern: /^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+(.[a-zA-Z0-9_-])+/,\r\n            message: \"请输入正确的邮箱地址\",\r\n          },\r\n        ],\r\n        birthday: [\r\n          {\r\n            required: true,\r\n            message: \"请选择出生日期\",\r\n            trigger: \"change\",\r\n          },\r\n        ],\r\n        telephone: [\r\n          {\r\n            required: true,\r\n            message: \"请输入电话号码\",\r\n            trigger: \"blur\",\r\n          },\r\n          {\r\n            min: 1,\r\n            max: 30,\r\n            message: \"长度在 1 到 30 位之间\",\r\n          },\r\n          {\r\n            pattern: /^1[3|4|5|7|8|9][0-9]\\d{8}$/,\r\n            message: \"请输入正确的电话号码\",\r\n          },\r\n        ],\r\n        address: [\r\n          {\r\n            required: true,\r\n            message: \"请输入地址\",\r\n            trigger: \"blur\",\r\n          }\r\n        ],\r\n        personalDesc: [\r\n          {\r\n            required: true,\r\n            message: \"请输入个人描述\",\r\n            trigger: \"blur\",\r\n          }\r\n        ],\r\n      }\r\n    };\r\n  },\r\n  methods: {\r\n    //性别数字换成字符\r\n    changeSexValue1() {\r\n      if(this.form.sex == 1) {\r\n        this.form.sex = \"男\";\r\n      }else {\r\n        this.form.sex = \"女\";\r\n      }\r\n    },\r\n    //性别换成数字\r\n    changeSexValue2() {\r\n      if(this.form.sex == \"男\"){\r\n        this.form.sex = 1\r\n      }else{\r\n        this.form.sex = 2\r\n      }\r\n    },\r\n    submit(form) {\r\n      this.changeSexValue2();//性别换成数字\r\n      this.form.age = Number.parseInt(this.form.age);\r\n      console.log(this.form);\r\n      this.$refs[form].validate((valid) => {\r\n        if (valid) {\r\n          Axios({\r\n            method:'put',\r\n            url:'user/updateuser',\r\n            data:qs.parse(this.form)\r\n          })\r\n          .then(response => {\r\n            let result = response.data;\r\n            if(result.code == 200) {\r\n              this.$message({\r\n                  type: 'success',\r\n                  message: '保存成功'\r\n              }); \r\n              this.getUserInformationData();\r\n            }else {\r\n                this.$message({\r\n                  type: 'error',\r\n                  message: '保存失败',\r\n                  showClose: true\r\n                });\r\n            }\r\n          })\r\n          .catch(error => {\r\n              this.$message({\r\n                type: 'error',\r\n                message: '系统错误',\r\n                showClose: true\r\n              }); \r\n          })\r\n        \r\n        } else {\r\n          console.log('保存失败');\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    getUserInformationData() {\r\n      Axios({\r\n            method:'get',\r\n            url:'/user/getuserbyuserid?userId='+Number.parseInt(sessionStorage.getItem('userId'))\r\n          })\r\n          .then(response => {\r\n            let result = response.data;\r\n            if(result.code == 200) {\r\n              this.form.address = result.data.address;\r\n              this.form.age = result.data.age;\r\n              this.form.email = result.data.email;\r\n              this.form.id = result.data.id;\r\n              this.form.birthday = result.data.birthday;\r\n              this.form.nickname = result.data.nickname;\r\n              this.form.personalDesc = result.data.personalDesc;\r\n              this.form.sex = result.data.sex;\r\n              this.form.telephone = result.data.telephone;\r\n              this.form.username = result.data.user.username;\r\n              this.form.userId=result.data.user.id;\r\n              this.form.credit = result.data.user.credit;\r\n              this.changeSexValue1();//性别数字换成字符\r\n            }\r\n          })\r\n          .catch(error => {\r\n            this.$message({\r\n                type: 'error',\r\n                message: '系统错误'\r\n          }); \r\n      })\r\n    }\r\n  },\r\n  created() {\r\n    this.getUserInformationData();\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.userInformation-container {\r\n  display: flex;\r\n  justify-content: center;\r\n  margin-top: 50px;\r\n}\r\n.information {\r\n  background-color: #fff;\r\n  height: 100%;\r\n  width: 1000px;\r\n  box-shadow: 0 2px 4px rgba(0, 0, 0, .12), 0 0 6px rgba(0, 0, 0, .04);\r\n  padding: 30px;\r\n  border-radius: 3px;\r\n}\r\n.btn {\r\n  margin: 10px 45%;\r\n}\r\n\r\n</style>"]}]}