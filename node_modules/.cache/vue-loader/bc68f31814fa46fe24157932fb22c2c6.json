{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\user\\modifyPassword.vue?vue&type=style&index=0&id=0d971dd9&scoped=true&lang=css&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\user\\modifyPassword.vue","mtime":1606355959832},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKDQouZGVtby1ydWxlRm9ybSB7DQogIGJvcmRlci1yYWRpdXM6M3B4Ow0KICBib3gtc2hhZG93OiAwIDBweCA3cHggMCByZ2JhKDAsIDAsIDAsIDAuMyk7DQogIHBhZGRpbmc6IDUwcHg7DQogIGhlaWdodDogMzUlOw0KICB3aWR0aDogMzUlOw0KICBiYWNrZ3JvdW5kLWNvbG9yOiAjZmZmOw0KfQ0KDQoubW9kaWZ5UGFzc3dvcmQtY29udGFpbmVyew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCiAgcGFkZGluZy10b3A6IDUwcHg7DQogIHBhZGRpbmctYm90dG9tOiAwMHB4Ow0KfQ0K"},{"version":3,"sources":["modifyPassword.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"modifyPassword.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\r\n  <div class=\"modifyPassword-container\">\r\n    <el-form\r\n      :model=\"ruleForm\"\r\n      :rules=\"rules\"\r\n      ref=\"ruleForm\"\r\n      label-width=\"100px\"\r\n      class=\"demo-ruleForm\"\r\n      label-position=\"left\">\r\n      <el-form-item label=\"原密码\" prop=\"originalPassword\">\r\n        <el-input\r\n          type=\"password\"\r\n          placeholder=\"请输入原密码\"\r\n          v-model=\"ruleForm.originalPassword\"\r\n          autocomplete=\"off\"\r\n        ></el-input>\r\n      </el-form-item>\r\n\r\n      <el-form-item label=\"新密码\" prop=\"newPassword\">\r\n        <el-input\r\n          type=\"password\"\r\n          placeholder=\"请输入新密码)\"\r\n          v-model=\"ruleForm.newPassword\"\r\n          autocomplete=\"off\"\r\n        ></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"确认新密码\" prop=\"confirmPassword\">\r\n        <el-input\r\n          type=\"password\"\r\n          placeholder=\"请确认新密码\"\r\n          v-model=\"ruleForm.confirmPassword\"\r\n          autocomplete=\"off\"\r\n        ></el-input>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"submitForm('ruleForm')\" style=\"margin-left:60px\">提交</el-button>\r\n        <el-button @click=\"resetForm('ruleForm')\" style=\"margin-left:90px\">重置</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport Axios from 'axios'\r\nimport qs from 'qs'\r\nexport default {\r\n  name: \"modifyPassword\",\r\n  data() {\r\n    var validatePass = (rule, value, callback) => {\r\n      if (value !== this.ruleForm.newPassword) {\r\n        callback(new Error(\"两次输入密码不一致!\"));\r\n      } else {\r\n        callback();\r\n      }\r\n    };\r\n    var validatePassRegx = (rule, value, callback) => {\r\n      let regx1 = /[`~!@#$%^&*()_\\-+=<>?:\"{}|,.\\/;'\\\\[\\]·~！@#￥%……&*（）——\\-+={}|《》？：“”【】、；‘'，。、]+/;\r\n      let regx2 = /[0-9]+/;\r\n      let regx3 = /[a-z]/;\r\n      if(!regx1.test(value)){\r\n        callback(\"密码缺少特殊字符\");\r\n      }\r\n      if(!regx2.test(value)){\r\n        callback(\"密码缺少数字\");\r\n      }\r\n      if(!regx3.test(value)){\r\n        callback(\"密码缺少字母\");\r\n      }\r\n      callback();\r\n    };\r\n    return {\r\n      ruleForm: {\r\n        originalPassword: \"\",\r\n        newPassword: \"\",\r\n        confirmPassword: \"\",\r\n      },\r\n      rules: {\r\n        originalPassword: [\r\n          {\r\n            required: true,\r\n            message: \"请输入旧密码\",\r\n            trigger: \"blur\",\r\n          },\r\n          // {\r\n          //   pattern: /^(?=.*\\d)(?=.*[a-zA-Z])(?=.*[~!@#$%^&*])[\\da-zA-Z~!@#$%^&*]{8,30}$/,\r\n          //   // pattern:/[`~!@#$%^&*()_\\-+=<>?:\"{}|,.\\/;'\\\\[\\]·~！@#￥%……&*（）——\\-+={}|《》？：“”【】、；‘'，。、]/im,\r\n          //   message: \"必须同时包含数字、字母和特殊字符\",\r\n          // },\r\n          { validator: validatePassRegx, trigger: 'blur' },\r\n          {\r\n            min: 8,\r\n            max: 30,\r\n            message: \"密码的长度在 8 到 30 位之间\",\r\n          }\r\n        ],\r\n        newPassword: [\r\n          {\r\n            required: true,\r\n            message: \"请输入新密码\",\r\n            trigger: \"blur\",\r\n          },\r\n          // {\r\n          //   pattern: /^(?=.*\\d)(?=.*[a-zA-Z])(?=.*[~!@#$%^&*])[\\da-zA-Z~!@#$%^&*]{8,30}$/,\r\n          //   message: \"必须同时包含数字、字母和特殊字符\",\r\n          // },\r\n          { validator: validatePassRegx, trigger: 'blur' },\r\n          {\r\n            min: 8,\r\n            max: 30,\r\n            message: \"密码的长度在 8 到 30 位之间\",\r\n          }\r\n        ],\r\n        confirmPassword: [\r\n          {\r\n            required: true,\r\n            message: \"请输入确认密码\",\r\n            trigger: \"blur\",\r\n          },\r\n          { validator: validatePass, trigger: 'blur' },\r\n          // {\r\n          //   pattern: /^(?=.*\\d)(?=.*[a-zA-Z])(?=.*[~!@#$%^&*])[\\da-zA-Z~!@#$%^&*]{8,30}$/,\r\n          //   message: \"必须同时包含数字、字母和特殊字符\",\r\n          // },\r\n          { validator: validatePassRegx, trigger: 'blur' },\r\n          {\r\n            min: 8,\r\n            max: 30,\r\n            message: \"密码的长度在 8 到 30 位之间\",\r\n          }\r\n        ],\r\n      },\r\n    };\r\n  },\r\n  methods: {\r\n    submitForm(formName) {\r\n      this.$refs[formName].validate((valid) => {\r\n        if (valid) {\r\n          Axios({\r\n            method:'post',\r\n            url:'user/modifypassword',\r\n            data:qs.parse({\r\n              userId:Number.parseInt(sessionStorage.getItem('userId')),\r\n              oldPassword:this.ruleForm.originalPassword,\r\n              newPassword:this.ruleForm.newPassword\r\n            })\r\n          })\r\n          .then(response => {\r\n            let result = response.data;\r\n            if(result.code == 200) {\r\n              this.$message({\r\n                  type: 'success',\r\n                  message: '保存成功'\r\n              }); \r\n              this.$refs.ruleForm.resetFields();\r\n            }else if(result.code == 107){\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: result.msg,//新密码和旧密码不同\r\n                    type: 'error'\r\n                });\r\n            }else if(result.code == 108){\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: result.msg,//旧密码错误\r\n                    type: 'error'\r\n                });\r\n            }\r\n            else {\r\n              this.$message({\r\n                type: 'error',\r\n                message: '保存失败',\r\n                showClose: true,\r\n              }); \r\n            }\r\n          })\r\n          .catch(error => {\r\n            this.$message({\r\n                type: 'error',\r\n                message: '系统错误',\r\n                showClose: true,\r\n              }); \r\n          })\r\n        } else {\r\n          console.log(\"保存失败\");\r\n          return false;\r\n        }\r\n      });\r\n    },\r\n    resetForm(formName) {\r\n      this.$refs[formName].resetFields();\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.demo-ruleForm {\r\n  border-radius:3px;\r\n  box-shadow: 0 0px 7px 0 rgba(0, 0, 0, 0.3);\r\n  padding: 50px;\r\n  height: 35%;\r\n  width: 35%;\r\n  background-color: #fff;\r\n}\r\n\r\n.modifyPassword-container{\r\n  display: flex;\r\n  justify-content: center;\r\n  padding-top: 50px;\r\n  padding-bottom: 00px;\r\n}\r\n</style>>"]}]}