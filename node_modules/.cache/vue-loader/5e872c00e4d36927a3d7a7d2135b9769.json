{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\user\\bookshelf.vue?vue&type=style&index=0&id=4357f72d&scoped=true&lang=css&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\user\\bookshelf.vue","mtime":1606377301873},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmJvb2tzaGVsZi1jb250YWluZXIgew0KICAgIG1hcmdpbjogMzBweCAxMDBweDsNCn0NCi50ZXh0IHsNCiAgICBmb250LXNpemU6IDE0cHg7DQogIH0NCg0KICAuaXRlbSB7DQogICAgbWFyZ2luLWJvdHRvbTogMThweDsNCiAgfQ0KDQogIC5jbGVhcmZpeDpiZWZvcmUsDQogIC5jbGVhcmZpeDphZnRlciB7DQogICAgZGlzcGxheTogdGFibGU7DQogICAgY29udGVudDogIiI7DQogIH0NCiAgLmNsZWFyZml4OmFmdGVyIHsNCiAgICBjbGVhcjogYm90aA0KICB9DQoNCiAgLmJveC1jYXJkIHsNCiAgICB3aWR0aDogOTAlOw0KICB9DQogIC5oZWFkbGluZSB7DQogICAgICB0ZXh0LWFsaWduOiBjZW50ZXI7DQogICAgICBmb250LXNpemU6IDI1cHg7DQogICAgICBwYWRkaW5nLWJvdHRvbTogNTBweDsNCiAgfQ0KICAgLmVsLXJvdyB7DQogICAgbWFyZ2luLWJvdHRvbTogMjBweDsNCiAgfQ0KICAuZWwtY29sIHsNCiAgICBib3JkZXItcmFkaXVzOiA0cHg7DQogIH0NCiAgLmluZm9ybWF0aW9uIHsNCiAgICBvdmVyZmxvdzogaGlkZGVuOw0KICAgIHRleHQtb3ZlcmZsb3c6IGVsbGlwc2lzOw0KICAgIGRpc3BsYXk6IC13ZWJraXQtYm94Ow0KICAgIC13ZWJraXQtYm94LW9yaWVudDogdmVydGljYWw7DQogICAgLXdlYmtpdC1saW5lLWNsYW1wOiA0Ow0KICAgIGhlaWdodDogNzZweDsNCiAgfQ0KICAuYm94Rm9udFNpemV7DQogICAgdGV4dC1hbGlnbjpjZW50ZXI7DQogICAgbGluZS1oZWlnaHQ6NDMwcHgNCiAgfQ0K"},{"version":3,"sources":["bookshelf.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsLA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"bookshelf.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\r\n    <div class=\"bookshelf-container\">\r\n        <div class=\"headline\">\r\n            我的书架\r\n        </div>\r\n        <el-row :gutter=\"20\" v-show=\"!flag\">\r\n            <el-col :span=\"8\" v-for=\"(item,index) in borrowingData\" v-bind:key=\"index\">\r\n                <el-card class=\"box-card\">\r\n                    <div slot=\"header\" class=\"clearfix\">\r\n                        <span class=\"showBook\">{{item.book.bookName}}</span>\r\n                        <div style=\"margin-top:10px\">\r\n                            <el-tag style=\" margin-right: 15px\" type=\"warning\"  v-if=\"item.borrowState == 0\">审核中</el-tag>\r\n                            <el-tag style=\"margin-right: 15px\" type=\"success\"  v-if=\"item.borrowState == 1\">借阅中</el-tag>\r\n                            <el-tag style=\"margin-right: 15px; cursor:pointer\" @click=\"renew(index,item.id)\" v-if=\"item.renewState == 0 && item.borrowState == 1 && !isOverdue(item.returnDate)\">申请续借</el-tag>\r\n                            <el-tag style=\"margin-right: 15px\" type=\"success\"  v-if=\"item.renewState == 1\">已续借</el-tag>\r\n                            <el-tag style=\"margin-right: 15px; cursor:pointer\" type=\"danger\" v-if=\"item.borrowState == 0\" @click=\"deleteBook(index,item.id)\">撤销借书</el-tag>\r\n                            <el-tag style=\"margin-right: 15px\" type=\"warning\"  v-if=\"isOverdue(item.returnDate)\">已逾期</el-tag>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"text item\">借阅日期：{{item.borrowDate | formatDate}}</div>\r\n                    <div class=\"text item\">归还日期：{{item.returnDate | formatDate}}</div>\r\n                    <div class=\"text item\">作者：{{item.book.author}}</div>\r\n                    <div class=\"text item\">类型：{{item.book.type.typeName}}</div>\r\n                    <div class=\"text item\">国家：{{item.book.country.countryName}}</div>\r\n                    <div class=\"text item\">篇幅：{{item.book.space}}</div>\r\n                    <div class=\"text item\">主题：{{item.book.theme.themeName}}</div>\r\n                    <div class=\"text item information\">简介：{{item.book.info}}</div>\r\n                </el-card>\r\n            </el-col>\r\n        </el-row> \r\n        <el-row :gutter=\"20\" v-show=\"flag\">\r\n            <el-col :span=\"8\" v-for=\"o in 3\" :key=\"o\">\r\n                <el-card class=\"box-card\" style=\"height:450px\">\r\n                    <div class=\"boxFontSize\">\r\n                       暂无书籍\r\n                    </div>\r\n                </el-card>\r\n            </el-col>\r\n        </el-row>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport {formatDate} from '../../assets/js/time.js'\r\nexport default {\r\n    name: \"bookshelf\",\r\n    data() {\r\n        return {\r\n            borrowingData: [],\r\n            flag:false\r\n        }\r\n    },\r\n    methods: {\r\n        //判断是否逾期\r\n        isOverdue(returnDate){\r\n            let now = new Date();\r\n            let returnDate1 = new Date(returnDate);\r\n            let nowMill = now.getTime();\r\n            let returnMill = returnDate1.getTime();\r\n            if(returnMill<nowMill){\r\n                return true;\r\n            }else{\r\n                return false;\r\n            }\r\n        },\r\n        //续借\r\n        renew(index,id) {\r\n            this.$confirm('此操作将申请续借该图书，每本书仅限续借一次（共30天）, 是否继续?', '提示', {\r\n                cancelButtonText: '取消',\r\n                confirmButtonText: '确定',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                axios.put(\"/borrowInfo/renewBook?id=\"+id)\r\n                .then(response => {\r\n                    if(response.data.code == 200) {\r\n                        this.getBookSelfData();//更新页面数据\r\n                        this.$message({\r\n                            type: 'success',\r\n                            message: '续借成功',\r\n                            showClose: true\r\n                        });\r\n                    }else {\r\n                        this.$message({\r\n                            type: 'info',\r\n                            message: '续借失败',\r\n                            showClose: true\r\n                        });\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    this.$message({\r\n                    type: 'info',\r\n                    message: '系统错误',\r\n                    showClose: true\r\n                }); \r\n                })  \r\n            }).catch(() => {\r\n                this.$message({\r\n                    type: 'info',\r\n                    message: '已取消续借',\r\n                    showClose: true\r\n                });          \r\n            });\r\n        },\r\n        //用户书架信息\r\n        getBookSelfData() {\r\n            axios.get(\"/borrowInfo/bookShelf?userId=\"+Number.parseInt(sessionStorage.getItem('userId')))\r\n            .then(response => {\r\n                let result = response.data;\r\n                if(result.code == 200) {\r\n                    // console.log(result.data);\r\n                    this.borrowingData = result.data;\r\n                    if(this.borrowingData.length == 0) {\r\n                        this.flag = !this.flag;\r\n                    }\r\n                }\r\n            })\r\n            .catch(error => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: '系统错误',\r\n                    type: 'error'\r\n                });\r\n            })\r\n        },\r\n        //未审核前可以删除该书\r\n        deleteBook(index,id) {\r\n            this.$confirm('此操作将取消借阅该图书, 是否继续?', '提示', {\r\n                cancelButtonText: '取消',\r\n                confirmButtonText: '确定',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                axios.delete(\"/borrowInfo/\"+id)\r\n                .then(response => {\r\n                    if(response.data.code == 200) {\r\n                        this.getBookSelfData();//更新当前页面数据\r\n                        this.$message({\r\n                            type: 'success',\r\n                            message: '取消借阅成功',\r\n                            showClose: true\r\n                        });\r\n                    }else {\r\n                        this.$message({\r\n                            type: 'info',\r\n                            message: '取消借阅失败',\r\n                            showClose: true\r\n                        });\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    this.$message({\r\n                    type: 'info',\r\n                    message: '系统错误',\r\n                    showClose: true\r\n                }); \r\n                })  \r\n            }).catch(() => {\r\n                this.$message({\r\n                    type: 'info',\r\n                    message: '关闭取消借阅请求',\r\n                    showClose: true\r\n                });          \r\n            });\r\n        }\r\n    },\r\n    created() {\r\n        this.getBookSelfData();\r\n    },\r\n    //时间过滤器，将TimeStamp类型数据换成自定义格式\r\n    filters: {\r\n      formatDate(time) {\r\n        let date = new Date(time);\r\n        // return formatDate(date, 'yyyy-MM-dd hh:mm');\r\n        return formatDate(date, 'yyyy-MM-dd');\r\n      }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.bookshelf-container {\r\n    margin: 30px 100px;\r\n}\r\n.text {\r\n    font-size: 14px;\r\n  }\r\n\r\n  .item {\r\n    margin-bottom: 18px;\r\n  }\r\n\r\n  .clearfix:before,\r\n  .clearfix:after {\r\n    display: table;\r\n    content: \"\";\r\n  }\r\n  .clearfix:after {\r\n    clear: both\r\n  }\r\n\r\n  .box-card {\r\n    width: 90%;\r\n  }\r\n  .headline {\r\n      text-align: center;\r\n      font-size: 25px;\r\n      padding-bottom: 50px;\r\n  }\r\n   .el-row {\r\n    margin-bottom: 20px;\r\n  }\r\n  .el-col {\r\n    border-radius: 4px;\r\n  }\r\n  .information {\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    display: -webkit-box;\r\n    -webkit-box-orient: vertical;\r\n    -webkit-line-clamp: 4;\r\n    height: 76px;\r\n  }\r\n  .boxFontSize{\r\n    text-align:center;\r\n    line-height:430px\r\n  }\r\n</style>"]}]}