{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\importAndExport.vue?vue&type=style&index=0&id=705d4924&scoped=true&lang=css&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\importAndExport.vue","mtime":1606299422195},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5jaG9zZS1maWxlew0KICBmbG9hdDogbGVmdDsNCn0NCi51cGxvYWQtY29udGFpbmVyew0KICBtYXJnaW4tdG9wOiAwOw0KICB3aWR0aDogNTAlOw0KfQ0KLmVsLXVwbG9hZF9fdGlwew0KICBmb250LXNpemU6IDE1cHg7DQp9DQouaW5saW5lLWJsb2NrIHsNCiAgZGlzcGxheTogaW5saW5lLWJsb2NrOw0KfQ0KLmltcG9ydEJ1dHRvbnsNCiAgbWFyZ2luLXRvcDogMDsNCiAgbWFyZ2luLWxlZnQ6IDEwcHg7DQogIG1hcmdpbi1yaWdodDogNSU7DQp9DQouRXhwb3J0QnV0dG9uew0KICBtYXJnaW4tbGVmdDogNSU7DQp9DQouaW1wb3J0QW5kRXhwb3J0LWNvbnRhaW5lcnsNCiAgbWFyZ2luOjUwcHg7DQp9DQo="},{"version":3,"sources":["importAndExport.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwHA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"importAndExport.vue","sourceRoot":"src/components/administrator","sourcesContent":["<template>\r\n  <div class=\"importAndExport-container\">\r\n    <div class=\"upload-container\">\r\n        <div class=\"chose-file\">\r\n          <el-upload\r\n          class=\"upload inline-block\"\r\n          action=\"\"\r\n          :on-exceed=\"handleExceed\"\r\n          :on-remove=\"handleRemove\"\r\n          :on-change=\"handleChange\"\r\n          :limit=\"1\"\r\n          :auto-upload=\"false\"\r\n          accept=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel\"\r\n          :file-list=\"fileList\">\r\n              <el-button size=\"large\" type=\"primary\">选取文件</el-button>\r\n              <div slot=\"tip\" class=\"el-upload__tip\">只能导入xls/xlsx文件</div>  \r\n          </el-upload>\r\n        </div>\r\n        <el-button class=\"importButton\" size=\"large\" type=\"success\" @click=\"importExcel\">导入数据</el-button>\r\n        \r\n        <a href=\"http://192.168.3.49:8089/library/export\">\r\n            <el-button class=\"ExportButton\" size=\"large\" type=\"warning\">导出数据</el-button>\r\n        </a>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nexport default {\r\n    name:\"importAndExport\",\r\n    data(){\r\n      return{\r\n          file:[{\r\n            name:\"\",\r\n            url:\"\",\r\n          }],\r\n          fileTemp:[],\r\n          fileList:[],\r\n      }\r\n    },\r\n    methods:{\r\n        handleChange(file,fileList){\r\n            this.fileTemp = file.raw;\r\n        },\r\n        handleRemove(file,fileList){\r\n            this.fileTemp = null;\r\n        },\r\n        handleExceed(file,fileList){\r\n            this.$message.warning(\r\n              `当前限制选择 1 个文件，本次选择了 ${files.length} 个文件\r\n              ，共选择了 ${files.length + fileList.length} 个文件`);\r\n        },\r\n        importExcel(){\r\n            console.log(this.fileTemp);\r\n            if(this.fileTemp.length!=0){\r\n                if((this.fileTemp.type == 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet')\r\n                    ||this.fileTemp.type == 'application/vnd.ms-excel'){\r\n                        let form = new FormData();\r\n                        form.append(\"file\",this.fileTemp);\r\n                        let config = {\r\n                            headers:{\r\n                                'Content-type': 'multipart/form-data'\r\n                            },\r\n                        }\r\n                        axios.post('/import',form,config).then(response=>{\r\n                            this.$message({\r\n                              showClose: true,\r\n                              message: '导入成功',\r\n                              type: 'success'\r\n                            });\r\n                        }).catch(error=>{\r\n                            this.$message({\r\n                              showClose: true,\r\n                              message: '导入错误',\r\n                              type: 'error'\r\n                            });\r\n                        })\r\n                  }else{\r\n                      this.$message({\r\n                          showClose: true,\r\n                          message: '导入文件格式不正确，请删除后重新上传',\r\n                          type: 'error'\r\n                      });\r\n                  }\r\n            }else{\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: '请上传附件',\r\n                    type: 'error'\r\n                });\r\n            }\r\n        },\r\n        ExportExcel(){\r\n             this.$confirm('此操作导出图书信息, 是否继续?', '提示', {\r\n                cancelButtonText: '取消',\r\n                confirmButtonText: '确定',\r\n                type: 'warning'\r\n            }).then(()=>{\r\n                axios({\r\n                    method:'get',\r\n                    url:'/export',\r\n                }).then(response=>{\r\n                     this.$message({\r\n                          type: 'success',\r\n                          message: '导出成功!'\r\n                      });\r\n                }).catch(error => {\r\n                    this.$message({\r\n                    type: 'info',\r\n                    message: '导出失败',\r\n                });\r\n            })\r\n        })\r\n        }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.chose-file{\r\n  float: left;\r\n}\r\n.upload-container{\r\n  margin-top: 0;\r\n  width: 50%;\r\n}\r\n.el-upload__tip{\r\n  font-size: 15px;\r\n}\r\n.inline-block {\r\n  display: inline-block;\r\n}\r\n.importButton{\r\n  margin-top: 0;\r\n  margin-left: 10px;\r\n  margin-right: 5%;\r\n}\r\n.ExportButton{\r\n  margin-left: 5%;\r\n}\r\n.importAndExport-container{\r\n  margin:50px;\r\n}\r\n</style>"]}]}