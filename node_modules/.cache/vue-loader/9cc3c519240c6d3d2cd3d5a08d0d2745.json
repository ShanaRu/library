{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\announcement.vue?vue&type=style&index=0&id=5c8702d9&scoped=true&lang=css&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\announcement.vue","mtime":1606384814993},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoNCi5kZW1vLWlucHV0LXN1ZmZpeCB7DQogICAgbWFyZ2luOiAzMHB4IDA7DQogICAgZmxvYXQ6IHJpZ2h0Ow0KfQ0KLnNlYXJjaElucHV0IHsNCiAgICB3aWR0aDogMzAwcHg7DQogICAgbWFyZ2luLXJpZ2h0OiAyMHB4Ow0KfQ0KLmVsLXBhZ2luYXRpb24gew0KICBkaXNwbGF5OiBmbGV4Ow0KICBqdXN0aWZ5LWNvbnRlbnQ6IGNlbnRlcjsNCn0NCg=="},{"version":3,"sources":["announcement.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiXA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"announcement.vue","sourceRoot":"src/components/administrator","sourcesContent":["<template>\r\n  <div class=\"announcement-container\">    \r\n    <div class=\"demo-input-suffix\">\r\n        <el-input\r\n            placeholder=\"请输入公告标题\" clearable maxlength=\"30\"\r\n            v-model=\"searchNoticeName\" class=\"searchInput\">\r\n            <i slot=\"prefix\" class=\"el-input__icon el-icon-search\"></i>\r\n        </el-input>\r\n        <el-button type=\"primary\" @click=\"searchAnnouncement\">查询公告</el-button>\r\n        <el-button type=\"success\" @click=\"handleAdd\">新增公告</el-button>\r\n    </div>  \r\n    <el-table\r\n      style=\"width: 100%\"\r\n      :data=\"userList.slice(0,7)\" \r\n      align=\"center\"\r\n      border\r\n     stripe>\r\n     <el-table-column prop=\"id\" label=\"编号\" min-width=\"6%\" align=\"center\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"noticeName\" label=\"标题\" min-width=\"20%\" align=\"center\" show-overflow-tooltip>\r\n      </el-table-column>\r\n      <el-table-column prop=\"content\" label=\"公告内容\" min-width=\"40%\" align=\"center\" show-overflow-tooltip>\r\n      </el-table-column>\r\n      <el-table-column prop=\"releaseTime\" label=\"发布时间\" min-width=\"9%\" align=\"center\">\r\n        <template slot-scope=\"scope\">{{scope.row.releaseTime | formatDate}}</template>\r\n      </el-table-column>\r\n      <el-table-column fixed=\"right\" label=\"操作\" min-width=\"10%\" align=\"center\">\r\n        <template slot-scope=\"scope\">\r\n          <el-button size=\"small\" @click=\"handleEdit(scope.$index, scope.row)\" type=\"info\" plain>编辑</el-button>\r\n          <el-button\r\n            v-if=\"userList.length > 0\"\r\n            size=\"small\"\r\n            type=\"danger\"\r\n            @click.native.prevent=\"delNotice(scope.row)\" plain>删除</el-button>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <!-- 编辑时候的弹出层 -->\r\n    <el-dialog\r\n      center\r\n      title=\"修改公告\"\r\n      :visible.sync=\"dialogFormVisible\"\r\n      width=\"40%\"\r\n      top=\"200px\"\r\n      :before-close=\"handleClose\">\r\n      <el-form :model=\"editForm\" ref=\"editFormRef\" :rules=\"rules\">\r\n        <el-form-item label=\"标题\" :label-width=\"formLabelWidth\" prop=\"noticeName\">\r\n          <el-input v-model=\"editForm.noticeName\" maxlength=\"30\" show-word-limit></el-input>\r\n        </el-form-item>\r\n        <el-form-item label=\"公告内容\" :label-width=\"formLabelWidth\" prop=\"content\">\r\n          <el-input v-model=\"editForm.content\" type=\"textarea\" :rows=\"8\" resize=\"none\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click.native=\"cancelEdit()\">取消</el-button>\r\n        <el-button type=\"primary\" @click.native=\"handleUpdate()\">更新公告</el-button\r\n        >\r\n      </div>\r\n    </el-dialog>\r\n    <!-- 新增时候的弹出层 -->\r\n    <el-dialog\r\n      center\r\n      title=\"新增公告\"\r\n      :visible.sync=\"FormVisible\"\r\n      width=\"50%\"\r\n      top=\"200px\"\r\n      :before-close=\"addClose\">\r\n      <el-form :model=\"addForm\" ref=\"addFormRef\" :rules=\"rule\">\r\n        <el-form-item\r\n          label=\"标题\"\r\n          :label-width=\"formLabelWidth\" \r\n          prop=\"noticeName\">\r\n          <el-input v-model=\"addForm.noticeName\" maxlength=\"30\" show-word-limit></el-input>\r\n        </el-form-item>\r\n        <el-form-item\r\n          label=\"公告内容\"\r\n          :label-width=\"formLabelWidth\"\r\n          prop=\"content\">\r\n          <el-input v-model=\"addForm.content\" type=\"textarea\" resize=\"none\" :rows=\"8\"></el-input>\r\n        </el-form-item>\r\n      </el-form>\r\n      <div slot=\"footer\" class=\"dialog-footer\">\r\n        <el-button @click.native=\"cancelAdd()\">取消</el-button>\r\n        <el-button type=\"primary\" @click.native=\"addNotice()\">添加公告</el-button\r\n        >\r\n      </div>\r\n    </el-dialog>\r\n    <el-pagination\r\n      @current-change=\"handleCurrentChange\"\r\n      :current-page=\"currentPage\"\r\n      :page-size=\"pagesize\"\r\n      layout=\"total,prev, pager, next, jumper\"\r\n      :total=\"totalLength\"\r\n      style=\"margin-top:20px;\"\r\n    >\r\n    </el-pagination>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport qs from 'qs'\r\nimport {formatDate} from '../../assets/js/time.js'\r\nexport default {\r\n  name: \"announcement\",\r\n  created() {},\r\n  data() {\r\n     var titlecontent = (rule, value, callback) => {\r\n        if (value == '') {\r\n          callback(new Error('请输入标题内容'));\r\n        } \r\n          callback();\r\n        };\r\n         var titlecontent = (rule, value, callback) => {\r\n        if (value == '') {\r\n          callback(new Error('请输入公告内容'));\r\n        } \r\n          callback();\r\n        };\r\n    return {\r\n      searchNoticeName:\"\",\r\n      editForm: {\r\n        noticeName: \"\",\r\n        content: \"\",\r\n      },\r\n      addForm: {\r\n        noticeName: \"\",\r\n        content: \"\",\r\n      },\r\n      rules: {\r\n        noticeName: [{ required: true, message: \"请输入标题内容\", trigger: \"blur\" }],\r\n        content: [\r\n          { required: true, message: \"请输入公告内容\", trigger: \"blur\" }\r\n        ],\r\n      },\r\n      rule: {\r\n        noticeName: [\r\n          { required: true,message: \"请输入标题内容\", trigger: \"blur\" }\r\n        ],\r\n        content: [\r\n          { required: true,  message: \"请输入公告内容\", trigger: \"blur\" }\r\n        ],\r\n      },\r\n      userList:[],\r\n      formLabelWidth: \"80px\",\r\n      dialogFormVisible: false,\r\n      FormVisible: false, //弹出层默认为关闭\r\n      currentPage: 1, //初始页\r\n      pagesize: 7, //每页的数据\r\n      totalLength:0\r\n    };\r\n  },\r\n  methods: {\r\n    //打开编辑框\r\n    handleEdit(index, row) {\r\n      this.dialogFormVisible = true; //dialog对话窗口打开\r\n      this.editForm = Object.assign({}, row); //将数据传入dialog页面，传递当前index\r\n    },\r\n    //关闭编辑框\r\n    cancelEdit() {\r\n      // this.$refs.editFormRef.resetFields();\r\n      this.dialogFormVisible = false;\r\n    },\r\n    //打开新增框\r\n    handleAdd: function () {\r\n      this.FormVisible = true;\r\n    },\r\n    //关闭新增框\r\n    cancelAdd() {\r\n      // this.$refs.addFormRef.resetFields();\r\n      this.FormVisible = false;\r\n    },\r\n    //更新公告\r\n    handleUpdate() {\r\n      this.$refs['editFormRef'].validate((valid) => {\r\n        if (valid) {\r\n          axios({\r\n            url:\"/notice\",\r\n            method: \"put\",\r\n            data:qs.parse({\r\n              noticeName:this.editForm.noticeName,\r\n              id:this.editForm.id,\r\n              content:this.editForm.content\r\n              })\r\n            })\r\n          .then(response => {\r\n              let result = response.data;\r\n              if(result.code == 200) {\r\n                  // console.log(result.data);\r\n                  this.getAnnouncementData(this.currentPage,this.pagesize);\r\n                  this.$message({\r\n                    message: '更新成功',\r\n                    type: 'success',\r\n                    showClose: true\r\n                  });\r\n              }\r\n          })\r\n          .catch(error => {\r\n              this.$message({\r\n                  showClose: true,\r\n                  message: '系统错误',\r\n                  type: 'error'\r\n              });\r\n          })\r\n          this.dialogFormVisible = false;\r\n        } else {\r\n          return false;\r\n        }\r\n      });  \r\n    },\r\n    //添加公告\r\n    addNotice() {\r\n      this.$refs['addFormRef'].validate((valid) => {\r\n        if (valid) {\r\n          axios({\r\n            url:\"/notice\",\r\n            method: \"post\",\r\n            data:qs.parse({\r\n              noticeName:this.addForm.noticeName,\r\n              id:this.addForm.id,\r\n              content:this.addForm.content\r\n              })\r\n            })\r\n          .then(response => {\r\n              let result = response.data;\r\n              if(result.code == 200) {\r\n                  // console.log(result.data);\r\n                  this.getAnnouncementData(this.currentPage,this.pagesize);\r\n                  this.$message({\r\n                    showClose: true,\r\n                    message: '添加成功',\r\n                    type: 'success'\r\n                  });\r\n                  this.$refs.addFormRef.resetFields();\r\n              }else {\r\n                  this.$message({\r\n                    showClose: true,\r\n                    message: '添加失败',\r\n                    type: 'error'\r\n                  });\r\n              }\r\n          })\r\n          .catch(error => {\r\n              this.$message({\r\n                  showClose: true,\r\n                  message: '系统错误',\r\n                  type: 'error'\r\n              });\r\n          })\r\n          this.FormVisible = false;\r\n          // console.log('sumbit');\r\n        } else {\r\n          return false;\r\n            console.log('errorsumbit');\r\n        }\r\n      });\r\n    },\r\n    //删除公告\r\n    delNotice(row) {\r\n      this.$confirm(\"该操作将删除该公告, 是否继续?\", \"提示\", {\r\n        confirmButtonText: \"确定\",\r\n        cancelButtonText: \"取消\",\r\n        type: \"warning\",\r\n      })\r\n      .then(() => {\r\n        axios({\r\n          method:'delete',\r\n          url:\"/notice/\"+row.id\r\n        })\r\n        .then(response => {\r\n            let result = response.data;\r\n            if(result.code == 200) {\r\n                // console.log(result.data);\r\n                this.getAnnouncementData(this.currentPage,this.pagesize);\r\n                this.$message({\r\n                  showClose: true,\r\n                  message: '删除成功',\r\n                  type: 'success'\r\n                });\r\n            }else {\r\n                this.$message({\r\n                  showClose: true,\r\n                  message: '删除失败',\r\n                  type: 'error'\r\n                });\r\n            }\r\n        })\r\n        .catch(error => {\r\n            this.$message({\r\n                showClose: true,\r\n                message: '系统错误',\r\n                type: 'error'\r\n            });\r\n        })\r\n      })\r\n      .catch(() => {\r\n        this.$message({\r\n          type: \"info\",\r\n          message: \"已取消删除\",\r\n        });\r\n      });\r\n    },\r\n    handleCurrentChange(currentPage) {\r\n      this.currentPage = currentPage;\r\n      this.getAnnouncementData(this.currentPage,this.pagesize);    \r\n    },\r\n    //在关闭编辑框前\r\n    handleClose(done){\r\n      this.$refs['editFormRef'].validate((valid) => {\r\n          if (valid) {\r\n            this.dialogFormVisible = false;\r\n          } else {\r\n            return false;\r\n          }\r\n        });\r\n    },\r\n    //在关闭新增框前\r\n    addClose(done){\r\n      this.$nextTick(() => {\r\n        this.$refs.addFormRef.resetFields();  \r\n      });\r\n       this.FormVisible = false;\r\n    },\r\n    getAnnouncementData(currentPage,pageSize){\r\n      axios({\r\n         method:'get',\r\n         url:\"/notice/query\",\r\n         params:{\r\n          name:this.searchNoticeName,\r\n          currentPage:currentPage,\r\n          pageSize:pageSize\r\n        }\r\n      })\r\n      .then(response => {\r\n          let result = response.data;\r\n          this.totalLength = result.count;\r\n          if(result.code == 200) {\r\n              this.userList = result.data;\r\n          }\r\n      })\r\n      .catch(error => {\r\n          this.$message({\r\n              showClose: true,\r\n              message: '系统错误',\r\n              type: 'error'\r\n          });\r\n      })\r\n    },\r\n    //查询公告\r\n    searchAnnouncement() {\r\n      this.currentPage = 1;\r\n      this.getAnnouncementData(1,this.pagesize);\r\n    }\r\n  },\r\n  created(){\r\n    this.getAnnouncementData(1,this.pagesize);\r\n  },\r\n  //时间过滤器，将TimeStamp类型数据换成自定义格式\r\n    filters: {\r\n      formatDate(time) {\r\n        let date = new Date(time);\r\n        // return formatDate(date, 'yyyy-MM-dd hh:mm');\r\n        return formatDate(date, 'yyyy-MM-dd');\r\n      }\r\n    }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.demo-input-suffix {\r\n    margin: 30px 0;\r\n    float: right;\r\n}\r\n.searchInput {\r\n    width: 300px;\r\n    margin-right: 20px;\r\n}\r\n.el-pagination {\r\n  display: flex;\r\n  justify-content: center;\r\n}\r\n</style>"]}]}