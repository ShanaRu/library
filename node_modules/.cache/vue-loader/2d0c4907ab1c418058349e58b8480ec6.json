{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\user\\bookshelf.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\user\\bookshelf.vue","mtime":1606377337621},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnDQppbXBvcnQge2Zvcm1hdERhdGV9IGZyb20gJy4uLy4uL2Fzc2V0cy9qcy90aW1lLmpzJw0KZXhwb3J0IGRlZmF1bHQgew0KICAgIG5hbWU6ICJib29rc2hlbGYiLA0KICAgIGRhdGEoKSB7DQogICAgICAgIHJldHVybiB7DQogICAgICAgICAgICBib3Jyb3dpbmdEYXRhOiBbXSwNCiAgICAgICAgICAgIGZsYWc6ZmFsc2UNCiAgICAgICAgfQ0KICAgIH0sDQogICAgbWV0aG9kczogew0KICAgICAgICAvL+WIpOaWreaYr+WQpumAvuacnw0KICAgICAgICBpc092ZXJkdWUocmV0dXJuRGF0ZSl7DQogICAgICAgICAgICBsZXQgbm93ID0gbmV3IERhdGUoKTsNCiAgICAgICAgICAgIGxldCByZXR1cm5EYXRlMSA9IG5ldyBEYXRlKHJldHVybkRhdGUpOw0KICAgICAgICAgICAgbGV0IG5vd01pbGwgPSBub3cuZ2V0VGltZSgpOw0KICAgICAgICAgICAgbGV0IHJldHVybk1pbGwgPSByZXR1cm5EYXRlMS5nZXRUaW1lKCk7DQogICAgICAgICAgICBpZihyZXR1cm5NaWxsPG5vd01pbGwpew0KICAgICAgICAgICAgICAgIHJldHVybiB0cnVlOw0KICAgICAgICAgICAgfWVsc2V7DQogICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlOw0KICAgICAgICAgICAgfQ0KICAgICAgICB9LA0KICAgICAgICAvL+e7reWAnw0KICAgICAgICByZW5ldyhpbmRleCxpZCkgew0KICAgICAgICAgICAgdGhpcy4kY29uZmlybSgn5q2k5pON5L2c5bCG55Sz6K+357ut5YCf6K+l5Zu+5Lmm77yM5q+P5pys5Lmm5LuF6ZmQ57ut5YCf5LiA5qyh77yI5YWxMzDlpKnvvIksIOaYr+WQpue7p+e7rT8nLCAn5o+Q56S6Jywgew0KICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLA0KICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywNCiAgICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycNCiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgIGF4aW9zLnB1dCgiL2JvcnJvd0luZm8vcmVuZXdCb29rP2lkPSIraWQpDQogICAgICAgICAgICAgICAgLnRoZW4ocmVzcG9uc2UgPT4gew0KICAgICAgICAgICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhLmNvZGUgPT0gMjAwKSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLmdldEJvb2tTZWxmRGF0YSgpOy8v5pu05paw6aG16Z2i5pWw5o2uDQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnc3VjY2VzcycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+e7reWAn+aIkOWKnycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfWVsc2Ugew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogJ2luZm8nLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfnu63lgJ/lpLHotKUnLA0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZQ0KICAgICAgICAgICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgICAgICB9KQ0KICAgICAgICAgICAgICAgIC5jYXRjaChlcnJvciA9PiB7DQogICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW5mbycsDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfns7vnu5/plJnor68nLA0KICAgICAgICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUNCiAgICAgICAgICAgICAgICB9KTsgDQogICAgICAgICAgICAgICAgfSkgIA0KICAgICAgICAgICAgfSkuY2F0Y2goKCkgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW5mbycsDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICflt7Llj5bmtojnu63lgJ8nLA0KICAgICAgICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUNCiAgICAgICAgICAgICAgICB9KTsgICAgICAgICAgDQogICAgICAgICAgICB9KTsNCiAgICAgICAgfSwNCiAgICAgICAgLy/nlKjmiLfkuabmnrbkv6Hmga8NCiAgICAgICAgZ2V0Qm9va1NlbGZEYXRhKCkgew0KICAgICAgICAgICAgYXhpb3MuZ2V0KCIvYm9ycm93SW5mby9ib29rU2hlbGY/dXNlcklkPSIrTnVtYmVyLnBhcnNlSW50KHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpKSkNCiAgICAgICAgICAgIC50aGVuKHJlc3BvbnNlID0+IHsNCiAgICAgICAgICAgICAgICBsZXQgcmVzdWx0ID0gcmVzcG9uc2UuZGF0YTsNCiAgICAgICAgICAgICAgICBpZihyZXN1bHQuY29kZSA9PSAyMDApIHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy5ib3Jyb3dpbmdEYXRhID0gcmVzdWx0LmRhdGE7DQogICAgICAgICAgICAgICAgICAgIGlmKHRoaXMuYm9ycm93aW5nRGF0YS5sZW5ndGggPT0gMCkgew0KICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5mbGFnID0gIXRoaXMuZmxhZzsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0NCiAgICAgICAgICAgIH0pDQogICAgICAgICAgICAuY2F0Y2goZXJyb3IgPT4gew0KICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUsDQogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfns7vnu5/plJnor68nLA0KICAgICAgICAgICAgICAgICAgICB0eXBlOiAnZXJyb3InDQogICAgICAgICAgICAgICAgfSk7DQogICAgICAgICAgICB9KQ0KICAgICAgICB9LA0KICAgICAgICAvL+acquWuoeaguOWJjeWPr+S7peWIoOmZpOivpeS5pg0KICAgICAgICBkZWxldGVCb29rKGluZGV4LGlkKSB7DQogICAgICAgICAgICB0aGlzLiRjb25maXJtKCfmraTmk43kvZzlsIblj5bmtojlgJ/pmIXor6Xlm77kuaYsIOaYr+WQpue7p+e7rT8nLCAn5o+Q56S6Jywgew0KICAgICAgICAgICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLA0KICAgICAgICAgICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywNCiAgICAgICAgICAgICAgICB0eXBlOiAnd2FybmluZycNCiAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gew0KICAgICAgICAgICAgICAgIGF4aW9zLmRlbGV0ZSgiL2JvcnJvd0luZm8vIitpZCkNCiAgICAgICAgICAgICAgICAudGhlbihyZXNwb25zZSA9PiB7DQogICAgICAgICAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEuY29kZSA9PSAyMDApIHsNCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuZ2V0Qm9va1NlbGZEYXRhKCk7Ly/mm7TmlrDlvZPliY3pobXpnaLmlbDmja4NCiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJG1lc3NhZ2Uoew0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6ICdzdWNjZXNzJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5Y+W5raI5YCf6ZiF5oiQ5YqfJywNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG93Q2xvc2U6IHRydWUNCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOw0KICAgICAgICAgICAgICAgICAgICB9ZWxzZSB7DQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsNCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiAnaW5mbycsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+WPlua2iOWAn+mYheWksei0pScsDQogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvd0Nsb3NlOiB0cnVlDQogICAgICAgICAgICAgICAgICAgICAgICB9KTsNCiAgICAgICAgICAgICAgICAgICAgfQ0KICAgICAgICAgICAgICAgIH0pDQogICAgICAgICAgICAgICAgLmNhdGNoKGVycm9yID0+IHsNCiAgICAgICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJywNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+ezu+e7n+mUmeivrycsDQogICAgICAgICAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZQ0KICAgICAgICAgICAgICAgIH0pOyANCiAgICAgICAgICAgICAgICB9KSAgDQogICAgICAgICAgICB9KS5jYXRjaCgoKSA9PiB7DQogICAgICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSh7DQogICAgICAgICAgICAgICAgICAgIHR5cGU6ICdpbmZvJywNCiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+WFs+mXreWPlua2iOWAn+mYheivt+axgicsDQogICAgICAgICAgICAgICAgICAgIHNob3dDbG9zZTogdHJ1ZQ0KICAgICAgICAgICAgICAgIH0pOyAgICAgICAgICANCiAgICAgICAgICAgIH0pOw0KICAgICAgICB9DQogICAgfSwNCiAgICBjcmVhdGVkKCkgew0KICAgICAgICB0aGlzLmdldEJvb2tTZWxmRGF0YSgpOw0KICAgIH0sDQogICAgLy/ml7bpl7Tov4fmu6TlmajvvIzlsIZUaW1lU3RhbXDnsbvlnovmlbDmja7mjaLmiJDoh6rlrprkuYnmoLzlvI8NCiAgICBmaWx0ZXJzOiB7DQogICAgICBmb3JtYXREYXRlKHRpbWUpIHsNCiAgICAgICAgbGV0IGRhdGUgPSBuZXcgRGF0ZSh0aW1lKTsNCiAgICAgICAgLy8gcmV0dXJuIGZvcm1hdERhdGUoZGF0ZSwgJ3l5eXktTU0tZGQgaGg6bW0nKTsNCiAgICAgICAgcmV0dXJuIGZvcm1hdERhdGUoZGF0ZSwgJ3l5eXktTU0tZGQnKTsNCiAgICAgIH0NCiAgICB9DQoNCn0NCg=="},{"version":3,"sources":["bookshelf.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2CA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA","file":"bookshelf.vue","sourceRoot":"src/components/user","sourcesContent":["<template>\r\n    <div class=\"bookshelf-container\">\r\n        <div class=\"headline\">\r\n            我的书架\r\n        </div>\r\n        <el-row :gutter=\"20\" v-show=\"!flag\">\r\n            <el-col :span=\"8\" v-for=\"(item,index) in borrowingData\" v-bind:key=\"index\">\r\n                <el-card class=\"box-card\">\r\n                    <div slot=\"header\" class=\"clearfix\">\r\n                        <span class=\"showBook\">{{item.book.bookName}}</span>\r\n                        <div style=\"margin-top:10px\">\r\n                            <el-tag style=\" margin-right: 15px\" type=\"warning\"  v-if=\"item.borrowState == 0\">审核中</el-tag>\r\n                            <el-tag style=\"margin-right: 15px\" type=\"success\"  v-if=\"item.borrowState == 1\">借阅中</el-tag>\r\n                            <el-tag style=\"margin-right: 15px; cursor:pointer\" @click=\"renew(index,item.id)\" v-if=\"item.renewState == 0 && item.borrowState == 1 && !isOverdue(item.returnDate)\">申请续借</el-tag>\r\n                            <el-tag style=\"margin-right: 15px\" type=\"success\"  v-if=\"item.renewState == 1\">已续借</el-tag>\r\n                            <el-tag style=\"margin-right: 15px; cursor:pointer\" type=\"danger\" v-if=\"item.borrowState == 0\" @click=\"deleteBook(index,item.id)\">撤销借书</el-tag>\r\n                            <el-tag style=\"margin-right: 15px\" type=\"warning\"  v-if=\"isOverdue(item.returnDate)\">已逾期</el-tag>\r\n                        </div>\r\n                    </div>\r\n                    <div class=\"text item\">借阅日期：{{item.borrowDate | formatDate}}</div>\r\n                    <div class=\"text item\">归还日期：{{item.returnDate | formatDate}}</div>\r\n                    <div class=\"text item\">作者：{{item.book.author}}</div>\r\n                    <div class=\"text item\">类型：{{item.book.type.typeName}}</div>\r\n                    <div class=\"text item\">国家：{{item.book.country.countryName}}</div>\r\n                    <div class=\"text item\">篇幅：{{item.book.space}}</div>\r\n                    <div class=\"text item\">主题：{{item.book.theme.themeName}}</div>\r\n                    <div class=\"text item information\">简介：{{item.book.info}}</div>\r\n                </el-card>\r\n            </el-col>\r\n        </el-row> \r\n        <el-row :gutter=\"20\" v-show=\"flag\">\r\n            <el-col :span=\"8\" v-for=\"o in 3\" :key=\"o\">\r\n                <el-card class=\"box-card\" style=\"height:450px\">\r\n                    <div class=\"boxFontSize\">\r\n                       暂无书籍\r\n                    </div>\r\n                </el-card>\r\n            </el-col>\r\n        </el-row>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport {formatDate} from '../../assets/js/time.js'\r\nexport default {\r\n    name: \"bookshelf\",\r\n    data() {\r\n        return {\r\n            borrowingData: [],\r\n            flag:false\r\n        }\r\n    },\r\n    methods: {\r\n        //判断是否逾期\r\n        isOverdue(returnDate){\r\n            let now = new Date();\r\n            let returnDate1 = new Date(returnDate);\r\n            let nowMill = now.getTime();\r\n            let returnMill = returnDate1.getTime();\r\n            if(returnMill<nowMill){\r\n                return true;\r\n            }else{\r\n                return false;\r\n            }\r\n        },\r\n        //续借\r\n        renew(index,id) {\r\n            this.$confirm('此操作将申请续借该图书，每本书仅限续借一次（共30天）, 是否继续?', '提示', {\r\n                cancelButtonText: '取消',\r\n                confirmButtonText: '确定',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                axios.put(\"/borrowInfo/renewBook?id=\"+id)\r\n                .then(response => {\r\n                    if(response.data.code == 200) {\r\n                        this.getBookSelfData();//更新页面数据\r\n                        this.$message({\r\n                            type: 'success',\r\n                            message: '续借成功',\r\n                            showClose: true\r\n                        });\r\n                    }else {\r\n                        this.$message({\r\n                            type: 'info',\r\n                            message: '续借失败',\r\n                            showClose: true\r\n                        });\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    this.$message({\r\n                    type: 'info',\r\n                    message: '系统错误',\r\n                    showClose: true\r\n                }); \r\n                })  \r\n            }).catch(() => {\r\n                this.$message({\r\n                    type: 'info',\r\n                    message: '已取消续借',\r\n                    showClose: true\r\n                });          \r\n            });\r\n        },\r\n        //用户书架信息\r\n        getBookSelfData() {\r\n            axios.get(\"/borrowInfo/bookShelf?userId=\"+Number.parseInt(sessionStorage.getItem('userId')))\r\n            .then(response => {\r\n                let result = response.data;\r\n                if(result.code == 200) {\r\n                    this.borrowingData = result.data;\r\n                    if(this.borrowingData.length == 0) {\r\n                        this.flag = !this.flag;\r\n                    }\r\n                }\r\n            })\r\n            .catch(error => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: '系统错误',\r\n                    type: 'error'\r\n                });\r\n            })\r\n        },\r\n        //未审核前可以删除该书\r\n        deleteBook(index,id) {\r\n            this.$confirm('此操作将取消借阅该图书, 是否继续?', '提示', {\r\n                cancelButtonText: '取消',\r\n                confirmButtonText: '确定',\r\n                type: 'warning'\r\n            }).then(() => {\r\n                axios.delete(\"/borrowInfo/\"+id)\r\n                .then(response => {\r\n                    if(response.data.code == 200) {\r\n                        this.getBookSelfData();//更新当前页面数据\r\n                        this.$message({\r\n                            type: 'success',\r\n                            message: '取消借阅成功',\r\n                            showClose: true\r\n                        });\r\n                    }else {\r\n                        this.$message({\r\n                            type: 'info',\r\n                            message: '取消借阅失败',\r\n                            showClose: true\r\n                        });\r\n                    }\r\n                })\r\n                .catch(error => {\r\n                    this.$message({\r\n                    type: 'info',\r\n                    message: '系统错误',\r\n                    showClose: true\r\n                }); \r\n                })  \r\n            }).catch(() => {\r\n                this.$message({\r\n                    type: 'info',\r\n                    message: '关闭取消借阅请求',\r\n                    showClose: true\r\n                });          \r\n            });\r\n        }\r\n    },\r\n    created() {\r\n        this.getBookSelfData();\r\n    },\r\n    //时间过滤器，将TimeStamp类型数据换成自定义格式\r\n    filters: {\r\n      formatDate(time) {\r\n        let date = new Date(time);\r\n        // return formatDate(date, 'yyyy-MM-dd hh:mm');\r\n        return formatDate(date, 'yyyy-MM-dd');\r\n      }\r\n    }\r\n\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.bookshelf-container {\r\n    margin: 30px 100px;\r\n}\r\n.text {\r\n    font-size: 14px;\r\n  }\r\n\r\n  .item {\r\n    margin-bottom: 18px;\r\n  }\r\n\r\n  .clearfix:before,\r\n  .clearfix:after {\r\n    display: table;\r\n    content: \"\";\r\n  }\r\n  .clearfix:after {\r\n    clear: both\r\n  }\r\n\r\n  .box-card {\r\n    width: 90%;\r\n  }\r\n  .headline {\r\n      text-align: center;\r\n      font-size: 25px;\r\n      padding-bottom: 50px;\r\n  }\r\n   .el-row {\r\n    margin-bottom: 20px;\r\n  }\r\n  .el-col {\r\n    border-radius: 4px;\r\n  }\r\n  .information {\r\n    overflow: hidden;\r\n    text-overflow: ellipsis;\r\n    display: -webkit-box;\r\n    -webkit-box-orient: vertical;\r\n    -webkit-line-clamp: 4;\r\n    height: 76px;\r\n  }\r\n  .boxFontSize{\r\n    text-align:center;\r\n    line-height:430px\r\n  }\r\n</style>"]}]}