{"remainingRequest":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\showUserInformation.vue?vue&type=style&index=0&id=610386fc&scoped=true&lang=css&","dependencies":[{"path":"D:\\IBM课件和代码\\work\\library\\src\\components\\administrator\\showUserInformation.vue","mtime":1606310820584},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\IBM课件和代码\\work\\library\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCg0KLmVsLWRpYWxvZ19fYm9keSB7DQogICAgcG9zaXRpb246IGFic29sdXRlOw0KICAgIGxlZnQ6IDA7DQogICAgdG9wOiA1NHB4Ow0KICAgIGJvdHRvbTogNzBweDsNCiAgICByaWdodDogMDsNCiAgICBwYWRkaW5nOiAwOw0KICAgIHotaW5kZXg6IDE7DQogICAgb3ZlcmZsb3c6IGhpZGRlbjsNCiAgICBvdmVyZmxvdy15OiBhdXRvOw0KfQ0KLmVsLWRpYWxvZ19fZm9vdGVyew0KICAgIHBvc2l0aW9uOiBhYnNvbHV0ZTsNCiAgICBsZWZ0OiAwOw0KICAgIHJpZ2h0OiAwOw0KICAgIGJvdHRvbTogMDsNCn0NCi5oaXN0b3J5ew0KICBmb250LXNpemU6IDIwcHg7DQogIGZsb2F0OmxlZnQ7DQp9DQouZGVtby1pbnB1dC1zdWZmaXggew0KICAgIG1hcmdpbjogMzBweCAwOw0KICAgIGZsb2F0OiByaWdodDsNCn0NCi5zZWFyY2hJbnB1dCB7DQogICAgd2lkdGg6IDMwMHB4Ow0KICAgIG1hcmdpbi1yaWdodDogMjBweDsNCn0NCi5lbC1wYWdpbmF0aW9uIHsNCiAgICBtYXJnaW4tdG9wOiAyMHB4Ow0KICAgIGRpc3BsYXk6IGZsZXg7DQogICAganVzdGlmeS1jb250ZW50OiBjZW50ZXI7DQogIH0NCg=="},{"version":3,"sources":["showUserInformation.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"showUserInformation.vue","sourceRoot":"src/components/administrator","sourcesContent":["<template>\r\n    <div class=\"showUserInformation-container\">\r\n        <div class=\"demo-input-suffix\">\r\n            <el-input placeholder=\"请输入用户姓名\" v-model=\"searchUsername\" type=\"text\" class=\"searchInput\" maxlength=\"30\" clearable>\r\n            <i slot=\"prefix\" class=\"el-input__icon el-icon-search\"></i></el-input>\r\n            <el-button @click=\"searchUser\" type=\"primary\">查询用户</el-button>\r\n        </div> \r\n        <el-table style=\"width: 100%;\"\r\n            :data=\"userList.slice(0,7)\" stripe border>\r\n            <el-table-column prop=\"user.id\" label=\"编号\" min-width=\"5%\" align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"nickname\" label=\"姓名\" min-width=\"8%\" align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"sex\" label=\"性别\" min-width=\"4%\"  align=\"center\">\r\n                <template slot-scope=\"scope\">\r\n                    <span v-if=\"scope.row.sex == 1\">男</span>\r\n                    <span v-if=\"scope.row.sex == 2\">女</span>\r\n                </template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"age\" label=\"年龄\" min-width=\"4%\"  align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"birthday\" label=\"生日\" min-width=\"8%\"  align=\"center\">\r\n                <template slot-scope=\"scope\">{{scope.row.birthday | formatDate}}</template>\r\n            </el-table-column>\r\n            <el-table-column prop=\"telephone\" label=\"电话\" min-width=\"10%\"  align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"email\" label=\"邮箱\" min-width=\"15%\"  align=\"center\"></el-table-column>\r\n            <el-table-column prop=\"address\" label=\"地址\" min-width=\"13%\"  align=\"center\" show-overflow-tooltip></el-table-column>\r\n            <el-table-column prop=\"personalDesc\" label=\"描述\" min-width=\"15%\"  align=\"center\" show-overflow-tooltip></el-table-column>\r\n            <el-table-column label=\"操作\" min-width=\"13%\"  align=\"center\">\r\n                <template slot-scope=\"scope\">\r\n            <el-button @click=\"handleClick(scope.row)\"  type=\"success\" size=\"small\" plain>借阅历史</el-button>\r\n                <el-button v-if=\"userList.length > 0\" size=\"small\" type=\"danger\" @click=\"del(scope.row)\" plain>注销</el-button>\r\n            </template>\r\n            </el-table-column>\r\n        </el-table>\r\n        <el-pagination\r\n            @current-change=\"handleCurrentChange\"\r\n            :current-page=\"currentPage\"\r\n            :page-size=\"pageSize\"         \r\n            layout=\"total, prev, pager, next, jumper\"\r\n            :total=\"dataLength\">\r\n        </el-pagination>\r\n        <el-dialog  :visible.sync=\"dialogTableVisible\" width=\"300\" class=\"abow_dialog\" center title=\"借阅历史\">\r\n            <el-table\r\n                :data=\"tableData.slice(0,5)\" style=\"100%\" height=\"430px\"\r\n                border>\r\n                <el-table-column prop=\"book.bookName\" align=\"center\" label=\"书籍名称\" min-width=\"30%\"></el-table-column>\r\n                <el-table-column prop=\"borrowDate\"     align=\"center\" label=\"借阅时间\" min-width=\"10%\">\r\n                    <template slot-scope=\"scope\">{{scope.row.borrowDate | formatDate}}</template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"returnDate\"     align=\"center\" label=\"应归还时间\" min-width=\"10%\">\r\n                    <template slot-scope=\"scope\">{{scope.row.returnDate | formatDate}}</template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"renewState\" align=\"center\" label=\"借阅有效期\" min-width=\"10%\">\r\n                <template scope=\"scope\">                    \r\n                    <p v-if=\"scope.row.renewState=='0'\">1个月</p>\r\n                    <p v-if=\"scope.row.renewState=='1'\">2个月</p>            \r\n                </template>\r\n                </el-table-column>\r\n                <el-table-column prop=\"right\" label=\"状态\" min-width=\"10%\" align=\"center\">\r\n                    <template slot-scope=\"scope\">\r\n                        <el-tag v-if=\"scope.row.borrowState == 0\" type=\"warning\">审核中</el-tag>\r\n                        <el-tag v-if=\"scope.row.borrowState == 1\" type=\"success\">借阅中</el-tag>\r\n                        <el-tag v-if=\"scope.row.borrowState == 2\" type=\"info\">已归还</el-tag>\r\n                        <el-tag v-if=\"scope.row.borrowState == -1\" type=\"danger\">拒绝借阅</el-tag>\r\n                    </template>\r\n                </el-table-column>\r\n            </el-table>\r\n            <el-pagination\r\n                @current-change=\"handleBoxCurrentChange\"\r\n                :current-page=\"boxCurrentPage\"\r\n                :page-size=\"boxPageSize\"         \r\n                layout=\"total, prev, pager, next, jumper\"\r\n                :total=\"tableLength\">\r\n            </el-pagination>\r\n            <span slot=\"footer\" class=\"dialog-footer\">\r\n                <el-button type=\"primary\" @click=\"dialogTableVisible = false\">关闭</el-button>\r\n            </span>\r\n        </el-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\nimport axios from 'axios'\r\nimport qs from 'qs'\r\nimport {formatDate} from '../../assets/js/time.js'\r\nexport default {\r\n    name: \"showUserInformation\",\r\n    data() {\r\n        return {\r\n            searchUsername:\"\",\r\n            boxCurrentPage:1,\r\n            boxPageSize:5,\r\n            dataLength:0,\r\n            dialogTableVisible: false,\r\n            currentPage:1, //初始页\r\n            pageSize:7,    //每页的数据\r\n            userList:[],\r\n            row:{},\r\n            tableData:[],\r\n            tableLength:0\r\n        }\r\n    },\r\n    created() {\r\n        this.getUserList(1,this.pageSize);\r\n    },\r\n    methods: {\r\n        handleClick(row){\r\n            this.row = row;\r\n            this.dialogTableVisible = true;\r\n            this.getUserBorrowingData(1,this.boxPageSize,row.user.id);\r\n        },\r\n        handleCurrentChange: function(currentPage){\r\n            this.currentPage = currentPage;\r\n            this.getUserList(currentPage,this.pageSize);\r\n        },\r\n        getUserList(currentPage,pageSize) { \r\n            axios({\r\n                method:'post',\r\n                url:\"/user/getuserinfolist\",\r\n                data:qs.parse({\r\n                    pageSize:pageSize,\r\n                    currentPage :currentPage,\r\n                    status:1,\r\n                    nickname:this.searchUsername\r\n                })\r\n            }).then(response => {\r\n                let result = response.data;\r\n                if(result.code == 200) {\r\n                    // console.log(result.data);\r\n                    this.userList = result.data;\r\n                    this.dataLength = result.count;\r\n                    // console.log(this.userList);\r\n                }\r\n            })\r\n            .catch(error => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: '错误',\r\n                    type: 'error'\r\n                });\r\n            })\r\n        },\r\n        del(row){\r\n            this.row = row;\r\n            console.log(this.row.user.id);\r\n            this.$confirm(\"永久删除该用户, 是否继续?\", \"提示\", {\r\n                confirmButtonText: \"确定\",\r\n                cancelButtonText: \"取消\",\r\n                type: \"warning\"\r\n            })\r\n            .then(() => {\r\n                axios({\r\n                    url:\"/user/usercancellation\",\r\n                    method: \"get\",\r\n                    params:{\r\n                        userId :this.row.user.id\r\n                    }\r\n                }).then(response=>{\r\n                    let result = response.data;\r\n                    console.log(result);\r\n                    if(result.code == 200) {\r\n                        this.$message({\r\n                            type: 'success',\r\n                            message: '注销成功'\r\n                        }); \r\n                        this.getUserList(this.currentPage,this.pageSize);\r\n                    }else if(result.code == 113){\r\n                        this.$message({\r\n                            type: 'info',\r\n                            message: result.msg\r\n                        });\r\n                    }else{\r\n                        this.$message({\r\n                            type: 'info',\r\n                            message: '注销失败'\r\n                        });\r\n                    }\r\n                }).catch(error=>{\r\n                    this.$message({\r\n                        type: 'info',\r\n                        message: '注销失败'\r\n                    });\r\n                })\r\n            })\r\n            .catch(() => {\r\n                this.$message({\r\n                    type: \"info\",\r\n                    message: \"已取消删除\"\r\n                });\r\n            });\r\n        },\r\n        handleBoxCurrentChange(boxCurrentPage) {\r\n            this.boxCurrentPage = boxCurrentPage;\r\n            this.getUserBorrowingData(this.boxCurrentPage,this.boxPageSize,this.row.user.id);\r\n        },\r\n        getUserBorrowingData(currentPage,pageSize,id){\r\n            axios({\r\n                method:'get',\r\n                url:\"/borrowInfo/userHistory\",\r\n                params:{\r\n                    currentPage:currentPage,\r\n                    pageSize:pageSize,\r\n                    userId:id\r\n                }\r\n            })\r\n            .then(response => {\r\n                let result = response.data;\r\n                this.tableData = result.data;\r\n                this.tableLength = result.count;\r\n                // console.log(result);\r\n                // console.log(this.tableLength);\r\n            })\r\n            .catch(error => {\r\n                this.$message({\r\n                    showClose: true,\r\n                    message: '错误',\r\n                    type: 'error'\r\n                });\r\n            })\r\n        },\r\n        searchUser() {\r\n            this.getUserList(1,this.pageSize)\r\n        }\r\n    },\r\n    filters: {\r\n      formatDate(time) {\r\n        let date = new Date(time);\r\n        // return formatDate(date, 'yyyy-MM-dd hh:mm');\r\n        return formatDate(date, 'yyyy-MM-dd');\r\n      }\r\n    }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.el-dialog__body {\r\n    position: absolute;\r\n    left: 0;\r\n    top: 54px;\r\n    bottom: 70px;\r\n    right: 0;\r\n    padding: 0;\r\n    z-index: 1;\r\n    overflow: hidden;\r\n    overflow-y: auto;\r\n}\r\n.el-dialog__footer{\r\n    position: absolute;\r\n    left: 0;\r\n    right: 0;\r\n    bottom: 0;\r\n}\r\n.history{\r\n  font-size: 20px;\r\n  float:left;\r\n}\r\n.demo-input-suffix {\r\n    margin: 30px 0;\r\n    float: right;\r\n}\r\n.searchInput {\r\n    width: 300px;\r\n    margin-right: 20px;\r\n}\r\n.el-pagination {\r\n    margin-top: 20px;\r\n    display: flex;\r\n    justify-content: center;\r\n  }\r\n</style>"]}]}